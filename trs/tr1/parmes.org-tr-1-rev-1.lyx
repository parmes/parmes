#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass scrartcl
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_title "1"
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\pdf_quoted_options "linkcolor=blue, urlcolor=blue, citecolor=blue"
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2cm
\topmargin 2cm
\rightmargin 2cm
\bottommargin 2cm
\headheight 1cm
\headsep 1cm
\footskip 1cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Titlehead
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
date{}
\end_layout

\end_inset

May, 2017
\end_layout

\begin_layout Subject
\begin_inset CommandInset href
LatexCommand href
name "parmes.org"
target "http://parmes.org"

\end_inset

 - technical report - 1 - revision - 1
\end_layout

\begin_layout Title
Co-rotated and reduced order
\begin_inset Newline newline
\end_inset

finite element time integrators
\begin_inset Newline newline
\end_inset

for multibody contact dynamics
\end_layout

\begin_layout Standard
\align center

\size larger
Summary
\end_layout

\begin_layout Standard
In this work we present two linearly implicit time integration methods,
 suitable for deformable multibody dynamic contact problems.
 The first approach co-rotates the initial linearized dynamic system which
 is therefore factorized only once.
 The second approach employs a reduced order base and produces a small dense
 system, efficient to deal with in the context of multibody dynamics; a
 modal base can also be used rendering the reduces system diagonal.
 We compare the proposed approaches with the unmodified Total Lagrangian
 finite element formulation, and where appropriate, with the rigid body
 approach.
 An implementation of presented methods is available at 
\begin_inset CommandInset href
LatexCommand href
target "https://github.com/tkoziara/solfec/"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Standard
\align center

\size larger
Contributors
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="1">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tomasz Koziara, t.koziara@gmail.com
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Steve Brasier, steve.brasier@atkinsglobal.com
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
≈Åukasz Kaczmarczyk, lukasz.kaczmarczyk@glasgow.ac.uk
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\align center

\emph on
This report is dedicated to Nenad:)
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Rigid kinematics is commonly used in multibody simulations (e.g.
 in robotics or to simulate granular flow).
 This level of kinematic description is often sufficient when dynamic effects
 corresponding to the deformable behavior of bodies can be neglected.
 Whenever this is not the case though, one runs into the computational bottlenec
k of processing many interacting bodies, discretized with fine finite element
 meshes.
 For robustness reasons explicit codes are usually picked to process such
 problems, although typically the dynamics on the time step scale is not
 of interest.
 On the other hand, general implicit FE codes usually struggle to process
 multibody contact/impact problems with many interacting bodies.
 For problems involving 100s, 1000s and more bodies, there is still little
 choice left (but explicit codes) in the realm of the off the shelf approaches.
\end_layout

\begin_layout Standard
In this paper we are in the context of multibody contact/impact problems,
 solved by means of implicit formulations.
 We address one of the building blocks of such frameworks, namely time integrati
on of deformable kinematics.
 We assume that the bodies are stiff, but undergo large rotations, as it
 is common for machines, blocky structures or granular flows.
 We reuse ideas from 
\begin_inset CommandInset citation
LatexCommand citep
key "Kaczmarczyk2012"

\end_inset

 (cf.
 Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Updating-rotation"

\end_inset

) and formulate two time integration methods, loosely based upon the scheme
 suggested by Zhang and Skeel 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang1997"

\end_inset

.
 The first approach only co-rotates the initial linearized dynamic system.
 The computational gain stems from the fact that the system is factorized
 only once.
 The second approach additionally employs a reduced order base and hence
 it produces a smaller, dense system.
 This approach is efficient in the context of implicit multibody dynamics
 involving impacts, where its small/dense algebra facilitates fast updates
 of the evolving and often rapidly changing system of constraint equations.
 An implementation of the presented approaches is include into an MPI-parallel
 code, Solfec, available at 
\begin_inset CommandInset href
LatexCommand href
target "https://github.com/tkoziara/solfec/"

\end_inset

.
\end_layout

\begin_layout Standard
The paper is organized as follows.
 Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Basic ideas"

\end_inset

 introduces some basic ides.
 Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Total-Lagrangian"

\end_inset

 briefly outlines the Total Lagrangian time integrator.
 Two simplifications follow: Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Co-rotated-stepping"

\end_inset

 describes the co-rotated time stepping approach without order reduction,
 while Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BC-RO"

\end_inset

 details the reduced order approach.
 Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Handling-constraints"

\end_inset

 contains some remarks about the treatment of constraints.
 Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Impacts"

\end_inset

 briefly introduces the impact/friction model and comments on energetic
 consistency.
 The examples follow in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Examples"

\end_inset

.
 The paper is concluded in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Conclusions"

\end_inset

, followed by appendices.
 Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Updating-rotation"

\end_inset

 outlines the method of updating rotation; Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BC-MODAL"

\end_inset

 shows how to replace the reduced order base with a modal one; Appendix
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Implementation"

\end_inset

 provides links to source code and examples files.
\end_layout

\begin_layout Section
Basic ideas
\begin_inset CommandInset label
LatexCommand label
name "sec:Basic ideas"

\end_inset


\end_layout

\begin_layout Standard
In this paper we work with bodies capable of large rigid motion and small
 elastic deformations (e.g.
 blocks of wood, metal or rock).
 Bodies are discretized by means of finite elements, with 
\begin_inset Formula $\mathbf{q}$
\end_inset

 denoting nodal displacements and 
\begin_inset Formula $\mathbf{u}$
\end_inset

 denoting nodal velocities, 
\begin_inset Formula $\mathbf{u}=\dot{\mathbf{q}}$
\end_inset

.
 Taking a single body, we parametrize its motion as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{x}\left(\mathbf{X},t\right)=\mathbf{X}+\mathbf{S}\left(\mathbf{X}\right)\mathbf{q}\left(t\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{x}$
\end_inset

 is a spatial point, 
\begin_inset Formula $\mathbf{X}$
\end_inset

 is a referential point, 
\begin_inset Formula $t$
\end_inset

 is time, and 
\begin_inset Formula $\mathbf{S}$
\end_inset

 stores finite element shape functions.
 Further derivations are motivated by a simple reasoning.
 We would like to model bodies interacting through frictional contact in
 dynamic situations.
 We decide to use the implicit in time Contact Dynamics method 
\begin_inset CommandInset citation
LatexCommand citep
key "Jean01,Moreau01"

\end_inset

, where nonlinearity is located both at the level of the per-body momentum
 balance (e.g.
 finite elasticity) and on the level of individual constraints (e.g.
 contact and friction).
 We wish to simplify computations and only deal with the nonlinearity at
 the constraints.
 Hence, we are interested in a linearly implicit time integration scheme.
 We start from the Total Lagrangian formulation 
\begin_inset CommandInset citation
LatexCommand citep
key "BLM00"

\end_inset

, which produces a constant mass matrix 
\begin_inset Formula $\mathbf{M}$
\end_inset

 and a stiffness matrix 
\begin_inset Formula $\mathbf{K}$
\end_inset

 that depends on the nodal displacements 
\begin_inset Formula $\mathbf{q}$
\end_inset

.
 For simplicity we diagonalize the mass matrix 
\begin_inset Formula $\mathbf{M}$
\end_inset

 by summing up its rows.
 For the Total Lagrangian formulation, in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Total-Lagrangian"

\end_inset

, we employ a linearly implicit integration scheme proposed by Zhang and
 Skeel 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang1997"

\end_inset

, where an operator employed in the discrete momentum balance has the following
 form
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
\mathbf{A}_{1}\left(t\right)=\mathbf{M}+\gamma\mathbf{K}\left(\mathbf{q}\left(t\right)\right)
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
with 
\begin_inset Formula $\gamma>0$
\end_inset

.
 Having to deal with this operator is expensive: it needs to be recomputed
 and inverted at every time step.
 Realizing that our bodies are roughly rigid we then ask: what if the above
 operator could be approximated by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{A}_{2}\left(t\right)=\mathbf{M}+\gamma\underline{\mathbf{\Lambda}}\left(t\right)\mathbf{K}_{0}\underline{\mathbf{\Lambda}}\left(t\right)^{T}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{\Lambda}$
\end_inset

 is a 
\begin_inset Formula $3\times3$
\end_inset

 rotation operator and 
\begin_inset Formula $\underline{\mathbf{\Lambda}}$
\end_inset

 denotes a block-diagonal square matrix composed of 
\begin_inset Formula $\mathbf{\Lambda}$
\end_inset

 and matching the dimension of 
\begin_inset Formula $\mathbf{K}_{0}=\mathbf{K}\left(\mathbf{q}\left(0\right)\right)$
\end_inset

.
 Because 
\begin_inset Formula $\mathbf{M}$
\end_inset

 is diagonal and for each node has the same 
\begin_inset Formula $x,y,z$
\end_inset

 components, we can write
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{A}_{2}\left(t\right)=\underline{\mathbf{\Lambda}}\left(t\right)\left(\mathbf{M}+\gamma\mathbf{K}_{0}\right)\underline{\mathbf{\Lambda}}\left(t\right)^{T}=\underline{\mathbf{\Lambda}}\left(t\right)\mathbf{A}_{0}\underline{\mathbf{\Lambda}}\left(t\right)^{T}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{A}_{0}=\mathbf{M}+\gamma\mathbf{K}_{0}$
\end_inset

 needs to be computed and inverted only once.
 In Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Co-rotated-stepping"

\end_inset

 we simply rewrite the Total Lagrangian time stepping with this idea in
 mind.
 Finally, in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BC-RO"

\end_inset

, we investigate whether a further saving would be possible by assuming
 that 
\begin_inset Formula $\mathbf{A}_{0}=\mathbf{E}^{T}\left(\mathbf{M}+\gamma\mathbf{K}_{0}\right)\mathbf{E}$
\end_inset

, where 
\begin_inset Formula $\mathbf{E}$
\end_inset

 collects selected 
\begin_inset Quotes eld
\end_inset

eigenmodes
\begin_inset Quotes erd
\end_inset

.
 In all three cases the linearly implicit scheme is essentially the same:
\end_layout

\begin_layout Enumerate
Compute the first explicit forward half-step.
\end_layout

\begin_layout Enumerate
At this half-step write down a discrete form of the momentum balance.
\end_layout

\begin_layout Enumerate
Compute the final implicit backward half-step.
\end_layout

\begin_layout Standard
To a large degree, the algorithmic details of what follows are a consequence
 of the fact that we are able to compute 
\begin_inset Formula $\mathbf{\Lambda}\left(t\right)$
\end_inset

 in a robust way (Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Updating-rotation"

\end_inset

).
 Because we consider small deformations about a possibly translated and
 rotated shape, it makes sense to talk about the gross rigid motion
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{x}_{r}\left(\mathbf{X},t\right)=\mathbf{\Lambda}\left(t\right)\left(\mathbf{X}-\mathbf{A}\right)+\mathbf{a}\left(t\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{\Lambda}$
\end_inset

 is the rotation operator, 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is a referential point, and 
\begin_inset Formula $\mathbf{a}$
\end_inset

 is a spatial image of 
\begin_inset Formula $\mathbf{A}$
\end_inset

.
 These two motions differ by the amount of deformation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{d}\left(\mathbf{X},t\right)=\mathbf{x}\left(\mathbf{X},t\right)-\mathbf{x}_{r}\left(\mathbf{X},t\right)\mbox{.}\label{eq:defo}
\end{equation}

\end_inset

Assuming that 
\begin_inset Formula $\mathbf{Z}_{i}$
\end_inset

 are coordinates of mesh nodes, we can collect 
\begin_inset Formula $\mathbf{d}\left(\mathbf{Z}_{i},t\right)$
\end_inset

 into a vector
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{d}=\left[\begin{array}{c}
...\\
\mathbf{Z}_{i}+\mathbf{q}_{i}-\mathbf{\Lambda}\left(\mathbf{Z}_{i}-\mathbf{A}\right)-\mathbf{a}\\
...
\end{array}\right]\label{eq:d}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{q}_{i}$
\end_inset

 represent displacements at node 
\begin_inset Formula $i$
\end_inset

.
 In the following sections 
\begin_inset Formula $\mathbf{d}$
\end_inset

 will be multiplied by a symmetric and semi-positive definite stiffness
 matrix 
\begin_inset Formula $\mathbf{K}$
\end_inset

 whose six zero eigenvalues correspond to the rigid modes (translations
 and infinitesimal rotations).
 Since any product of 
\begin_inset Formula $\mathbf{K}$
\end_inset

 with a displacement field corresponding to a rigid translation produces
 a zero vector, 
\begin_inset Formula $\mathbf{A}$
\end_inset

 and 
\begin_inset Formula $\mathbf{a}$
\end_inset

 can be skipped in the above formula.
 Hence, we can redefine 
\begin_inset Formula $\mathbf{d}$
\end_inset

 as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{d}=\left[\begin{array}{c}
...\\
\left(\mathbf{I}-\mathbf{\Lambda}\right)\mathbf{Z}_{i}+\mathbf{q}_{i}\\
...
\end{array}\right]=\left(\underline{\mathbf{I}-\mathbf{\Lambda}}\right)\mathbf{Z}+\mathbf{q}\label{eq:d1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{I}$
\end_inset

 is the 
\begin_inset Formula $3\times3$
\end_inset

 identity and 
\begin_inset Formula $\underline{\mathbf{I}-\mathbf{\Lambda}}$
\end_inset

 denotes a block-diagonal square matrix composed of 
\begin_inset Formula $\left(\mathbf{I}-\mathbf{\Lambda}\right)$
\end_inset

.
 Equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:d1"

\end_inset

) corresponds to the below deformation evaluated at mesh nodes 
\begin_inset Formula 
\begin{equation}
\mathbf{d}\left(\mathbf{X},t\right)=\mathbf{x}\left(\mathbf{X},t\right)-\mathbf{\Lambda}\left(t\right)\mathbf{X}\label{eq:defo1}
\end{equation}

\end_inset

which, as a difference between the current deformed position and the current
 rotated position (without translation), superposes the rigid translation
 and the small deformations of the body.
 As a result antisymmetric part of the gradient of 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
(
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:defo1"

\end_inset

)
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
 equals to the antisymmetric part of the gradient of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:defo"

\end_inset

).
 This fact is used in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Updating-rotation"

\end_inset

.
 We should note, that simplification (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:d1"

\end_inset

) is not necessary in general and it would make no difference if 
\begin_inset Formula $\mathbf{A}$
\end_inset

 and 
\begin_inset Formula $\mathbf{a}$
\end_inset

 were maintained throughout our derivations.
 The simplification stems from our implementation 
\begin_inset CommandInset citation
LatexCommand citep
key "Koziara2010"

\end_inset

, where kinematic models are combined with Lagrange multipliers imposing
 boundary conditions, and hence all bodies are nominally unconstrained.
\end_layout

\begin_layout Section
Total Lagrangian time stepping (TL)
\begin_inset CommandInset label
LatexCommand label
name "sec:Total-Lagrangian"

\end_inset


\end_layout

\begin_layout Standard
Consider a multi-body domain with constraints.
 Let the constraint reactions be denoted by 
\begin_inset Formula $\mathbf{R}$
\end_inset

 and the relative constraints velocities be denoted by 
\begin_inset Formula $\mathbf{U}$
\end_inset

.
 Let also the constraints equations be denoted by 
\begin_inset Formula $\mathbf{C}\left(\mathbf{U},\mathbf{R}\right)=\mathbf{0}$
\end_inset

.
 
\begin_inset Formula $\mathbf{R}$
\end_inset

 and 
\begin_inset Formula $\mathbf{U}$
\end_inset

 can be pictured as column vectors comprising 3-component sub-vectors, denoting
 reactions and velocities at individual constraint points.
 When talking about 
\begin_inset Formula $\mathbf{q}$
\end_inset

, 
\begin_inset Formula $\mathbf{u}$
\end_inset

 etc.
 we mean suitable collections of per-body entities.
 In order to integrate in time, a half-step configuration is extrapolated
 first
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h/2}=\mathbf{q}^{t}+\frac{h}{2}\mathbf{u}^{t}\label{eq:qhalf1}
\end{equation}

\end_inset

A global 
\begin_inset Formula $\mathbf{u}$
\end_inset

 to local 
\begin_inset Formula $\mathbf{U}$
\end_inset

 velocity transformation operator is computed next
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{H}=\mathbf{H}\left(\mathbf{q}^{t+h/2}\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{H}$
\end_inset

 is a global to local coordinates transformation of the shape functions
 values nonzero at constraint points.
 The number of rows of 
\begin_inset Formula $\mathbf{H}$
\end_inset

 depends on the number of constraints, while its rank is related to their
 linear independence.
 For example if we think about a relative velocity between two material
 points of two bodies 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $j$
\end_inset

 being in contact at a spatial point 
\begin_inset Formula $\mathbf{x}_{\alpha}$
\end_inset

, we can express 
\begin_inset Formula $\mathbf{H}\left(\mathbf{q}^{t+h/2}\right)$
\end_inset

 as 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{H}\left(\mathbf{q}^{t+h/2}\right)=\left\{ \mathbf{e}\right\} ^{T}\left[\begin{array}{ccccc}
\mbox{zeros} & \mathbf{S}_{i}\left(\mathbf{X}\left(\mathbf{q}_{i}^{t+h/2},\mathbf{x}_{\alpha}\right)\right) & \mbox{zeros} & -\mathbf{S}_{j}\left(\mathbf{X}\left(\mathbf{q}_{j}^{t+h/2},\mathbf{x}_{\alpha}\right)\right) & \mbox{zeros}\end{array}\right]
\end{equation}

\end_inset

where in addition 
\begin_inset Formula $\left\{ \mathbf{e}\right\} =\left\{ \mathbf{e}_{T1},\mathbf{e}_{T2},\mathbf{e}_{N}\right\} $
\end_inset

 is a local orthonormal coordinate system with two tangential and one normal
 direction, that we may wish to use.
 In cases with many constraints (e.g.
 contact points) 
\begin_inset Formula $\mathbf{H}$
\end_inset

 will be composed from multiple rows similar to the three-row operator above.
 In the next step, the momentum balance
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{b}=h\mathbf{f}_{ext}^{t+h/2}-h\mathbf{f}_{int}\left(\mathbf{q}^{t+h/2}\right)-h\mathbf{K}\left(\mathbf{q}^{t+h/2}\right)\eta\mathbf{u}^{t}\label{eq:b1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula 
\begin{equation}
\left(\mathbf{M}+\left(\frac{\eta h}{2}+\frac{h^{2}}{4}\right)\mathbf{K}\left(\mathbf{q}^{t+h/2}\right)\right)\left(\mathbf{u}^{t+h}-\mathbf{u}^{t}\right)=\mathbf{b}+\mathbf{H}^{T}\mathbf{R}\label{eq:mbc1}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
together with the transformation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}=\mathbf{H}\mathbf{u}^{t+h}
\end{equation}

\end_inset

and the constraints equations
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{C}\left(\mathbf{U},\mathbf{R}\right)=\mathbf{0}
\end{equation}

\end_inset

are used to evaluate the velocity 
\begin_inset Formula $\mathbf{u}^{t+h}$
\end_inset

 and the constraint reactions 
\begin_inset Formula $\mathbf{R}$
\end_inset

.
 This is further commented on in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Handling-constraints"

\end_inset

.
 The stiffness-proportional damping in the form of 
\begin_inset Formula $\eta\mathbf{K}\left(\mathbf{q}^{t+h/2}\right)\left(\mathbf{u}^{t+h}+\mathbf{u}^{t}\right)/2$
\end_inset

 contributes on the left and right hand side of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mbc1"

\end_inset

).
 This is a pragmatic device: it allows to avoid uninteresting oscillations
 as well as, to some extent, drive a post-impact behavior.
 While more will be said about this in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Examples"

\end_inset

, for the time being let us assume that this term is going to be useful
 and preserve it in the following two sections.
 Finally, the end-step configuration is updated
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h}=\mathbf{q}^{t+h/2}+\frac{h}{2}\mathbf{u}^{t+h}\mbox{.}\label{eq:qfull1}
\end{equation}

\end_inset

The above scheme is linearly implicit: as far as unconstrained motion is
 concerned only one linear system needs to be solved per time step.
 Without damping and constraints it amounts to the time-reversible scheme
 by Zhang and Skeel 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang1997"

\end_inset

, with the choice of 
\begin_inset Formula $\alpha=1/4$
\end_inset

 in their algorithm.
 The most general, fully implicit scheme in 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang1997"

\end_inset

 can be rewritten as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h/2}=\mathbf{q}^{t}+\frac{h}{2}\mathbf{u}^{t}\label{eq:qhalf2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{f}^{t+h/2}=\mathbf{M}^{-1}\left(\mathbf{f}_{ext}^{t+h/2}-\mathbf{f}_{int}\left(\mathbf{q}^{t+h/2}+\alpha h^{2}\mathbf{f}^{t+h/2}\right)\right)\label{eq:fhalf2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{u}^{t+h}=\mathbf{u}^{t}+h\mathbf{f}^{t+h/2}\label{eq:uful2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h}=\mathbf{q}^{t+h/2}+\frac{h}{2}\mathbf{u}^{t+h}\label{eq:qfull2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\alpha=1/4$
\end_inset

 produces the implicit mid-point rule, exactly conserving energy for linear
 problems 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang1997"

\end_inset

.
 Nonlinear systems integrated with (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:qhalf2"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:qfull2"

\end_inset

) experience a positive energy drift, visible in the long term.
 This however is of lesser concern in short simulations, where in addition
 frictional and viscous effects are purposely introduced.
 We should note, that exact energy conservation in finite elastodynamics
 has been achieved algorithmically on the stress integration level 
\begin_inset CommandInset citation
LatexCommand citep
key "Simo1992,Laursen2001"

\end_inset

, something which is not possible if one aims at the kind of simplifications
 pursued here.
 As our scheme is akin to the mid-point rule, second order accuracy should
 be expected for smooth, unconstrained problems.
 This is indeed the case, as demonstrated numerically in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Examples"

\end_inset

.
 The linearly implicit scheme (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:qhalf1"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:qfull1"

\end_inset

) follows from (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:qhalf2"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:qfull2"

\end_inset

) by starting from 
\begin_inset Formula $\mathbf{f}^{t+h/2}=\mathbf{0}$
\end_inset

 and taking one Newton step
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{M}\left(\mathbf{0}+\triangle\mathbf{f}^{t+h/2}\right)=\mathbf{f}_{ext}^{t+h/2}-\mathbf{f}_{int}\left(\mathbf{q}^{t+h/2}+\alpha h^{2}\mathbf{0}\right)-\alpha h^{2}\mathbf{K}\left(\mathbf{q}^{t+h/2}+\alpha h^{2}\mathbf{0}\right)\triangle\mathbf{f}^{t+h/2}
\end{equation}

\end_inset

which for 
\begin_inset Formula $\alpha=1/4$
\end_inset

 yields
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left(\mathbf{M}+\frac{h^{2}}{4}\mathbf{K}\left(\mathbf{q}^{t+h/2}\right)\right)\triangle\mathbf{f}^{t+h/2}=\mathbf{f}_{ext}^{t+h/2}-\mathbf{f}_{int}\left(\mathbf{q}^{t+h/2}\right)
\end{equation}

\end_inset

and combined with (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:uful2"

\end_inset

) results in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:qhalf1"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:qfull1"

\end_inset

), without the constraints and viscous damping.
\end_layout

\begin_layout Section
Body co-rotated time stepping (BC)
\begin_inset CommandInset label
LatexCommand label
name "sec:Co-rotated-stepping"

\end_inset

 
\end_layout

\begin_layout Standard
Once again, consider a multi-body domain with constraints.
 Let 
\begin_inset Formula $\mathbf{R}$
\end_inset

, 
\begin_inset Formula $\mathbf{U}$
\end_inset

 and 
\begin_inset Formula $\mathbf{C}\left(\mathbf{U},\mathbf{R}\right)=\mathbf{0}$
\end_inset

 retain their meaning from the previous section.
 When talking about 
\begin_inset Formula $\mathbf{q}$
\end_inset

, 
\begin_inset Formula $\mathbf{u}$
\end_inset

 
\emph on
and
\emph default
 
\begin_inset Formula $\mathbf{\Lambda}$
\end_inset

, etc.
 we now again mean suitable collections of per-body entities.
 In order to integrate in time, a half-step configuration is extrapolated
 first
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h/2}=\mathbf{q}^{t}+\frac{h}{2}\mathbf{u}^{t}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{\Lambda}_{1}=\hat{\mathbf{\Lambda}}\left(\mathbf{q}^{t+h/2},\mathbf{\Lambda}^{t}\right)\mbox{.}\label{eq:L1}
\end{equation}

\end_inset

Function 
\begin_inset Formula $\hat{\mathbf{\Lambda}}\left(\cdot,\cdot\right)$
\end_inset

 is detailed Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Updating-rotation"

\end_inset

; here we treat it as a 
\begin_inset Quotes eld
\end_inset

black-box
\begin_inset Quotes erd
\end_inset

.
 A global 
\begin_inset Formula $\mathbf{u}$
\end_inset

 to local 
\begin_inset Formula $\mathbf{U}$
\end_inset

 velocity transformation operator is computed next
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{H}=\mathbf{H}\left(\mathbf{q}^{t+h/2}\right)
\end{equation}

\end_inset

the same way as in the previous section.
 The momentum balance
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{b}=h\mathbf{f}^{t+h/2}-h\underline{\mathbf{\Lambda}_{1}}\mathbf{K}_{0}\underline{\mathbf{\Lambda}_{1}}^{T}\left[\left(\underline{\mathbf{I}-\mathbf{\Lambda}_{1}}\right)\mathbf{Z}+\mathbf{q}^{t+h/2}+\eta\mathbf{u}^{t}\right]\label{eq:b}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula 
\begin{equation}
\underline{\mathbf{\Lambda}_{1}}\left(\mathbf{M}+\left(\frac{\eta h}{2}+\frac{h^{2}}{4}\right)\mathbf{K}_{0}\right)\underline{\mathbf{\Lambda}_{1}}^{T}\left(\mathbf{u}^{t+h}-\mathbf{u}^{t}\right)=\mathbf{b}+\mathbf{H}^{T}\mathbf{R}\label{eq:mbc}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
together with the transformation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}=\mathbf{H}\mathbf{u}^{t+h}
\end{equation}

\end_inset

and the constraints equations
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{C}\left(\mathbf{U},\mathbf{R}\right)=\mathbf{0}
\end{equation}

\end_inset

are now used to evaluate the velocity 
\begin_inset Formula $\mathbf{u}^{t+h}$
\end_inset

 and the constraint reactions 
\begin_inset Formula $\mathbf{R}$
\end_inset

.
 Here the stiffness-proportional damping in the form of 
\begin_inset Formula $\eta\underline{\mathbf{\Lambda}_{1}}\mathbf{K}\underline{\mathbf{\Lambda}_{1}}^{T}\left(\mathbf{u}^{t+h}+\mathbf{u}^{t}\right)/2$
\end_inset

 contributes on the left and right hand side of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mbc"

\end_inset

).
 Finally, the end-step configuration is updated
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h}=\mathbf{q}^{t+h/2}+\frac{h}{2}\mathbf{u}^{t+h}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{\Lambda}^{t+h}=\hat{\mathbf{\Lambda}}\left(\mathbf{q}^{t+h},\mathbf{\Lambda}_{1}\right)\mbox{.}\label{eq:L2}
\end{equation}

\end_inset

Without the constraints, the above scheme is again linearly implicit.
 Combined with a set of nonlinear constraints, it constitutes a fully implicit
 time-stepping, where the nonlinearity is pushed solely to the constraints.
 Of course, the whole point of using the co-rotated formulation is in the
 ease of inverting
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{A}=\underline{\mathbf{\Lambda}_{1}}\left(\mathbf{M}+\left(\frac{\eta h}{2}+\frac{h^{2}}{4}\right)\mathbf{K}\right)\underline{\mathbf{\Lambda}_{1}}^{T}=\underline{\mathbf{\Lambda}_{1}}\mathbf{A}_{0}\underline{\mathbf{\Lambda}_{1}}^{T}
\end{equation}

\end_inset

since it is enough to invert 
\begin_inset Formula $\mathbf{A}_{0}$
\end_inset

 only once
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{A}^{-1}=\left[\underline{\mathbf{\Lambda}_{1}}\mathbf{A}_{0}\underline{\mathbf{\Lambda}_{1}}^{T}\right]^{-1}=\underline{\mathbf{\Lambda}_{1}}\left[\underline{\mathbf{\Lambda}_{1}}\mathbf{A}_{0}\right]^{-1}=\underline{\mathbf{\Lambda}_{1}}\mathbf{A}_{0}^{-1}\underline{\mathbf{\Lambda}_{1}}^{T}\mbox{.}
\end{equation}

\end_inset


\end_layout

\begin_layout Section
Body co-rotated, reduced order approach (BC-RO)
\begin_inset CommandInset label
LatexCommand label
name "sec:BC-RO"

\end_inset


\end_layout

\begin_layout Standard
The BC time stepping described in the previous section may be useful in
 some situations.
 Nevertheless, we can still aim at optimizing the runtime by employing a
 reduced order base.
 Let such base be spanned by columns of a matrix 
\begin_inset Formula $\mathbf{E}$
\end_inset

 so that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{E}^{T}\mathbf{E}=\mbox{diag}\left(1\right)
\end{equation}

\end_inset

and hence 
\begin_inset Formula $\mathbf{E}$
\end_inset

 stores orthogonal 
\begin_inset Quotes eld
\end_inset

eigenvectors
\begin_inset Quotes erd
\end_inset

.
 System matrices can be projected onto this basis to produce
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{M}}=\mathbf{E}^{T}\mathbf{M}\mathbf{E}\mbox{ and }\bar{\mathbf{K}}=\mathbf{E}^{T}\mathbf{K}\mathbf{E}\text{,}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit
which are symmetrical and dense.
 We shall work with two sets of variables, the full (space) configuration
 and velocity 
\begin_inset Formula $\mathbf{q}$
\end_inset

 and 
\begin_inset Formula $\mathbf{u}$
\end_inset

, and the reduced (space) configuration and velocity 
\begin_inset Formula $\bar{\mathbf{q}}$
\end_inset

 and 
\begin_inset Formula $\bar{\mathbf{u}}$
\end_inset

.
 As before we also use the rotation operator 
\begin_inset Formula $\mathbf{\Lambda}$
\end_inset

 representing the gross rigid rotation of the entire body.
 Our intention is to work out a time stepping that closely mimics the co-rotated
 approach from the previous section, but employs the momentum balance only
 in the reduced space.
 We start in the usual way
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h/2}=\mathbf{q}^{t}+\frac{h}{2}\mathbf{u}^{t}\label{eq:qhalf}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{\Lambda}_{1}=\hat{\mathbf{\Lambda}}\left(\mathbf{q}^{t+h/2},\mathbf{\Lambda}^{t}\right)\mbox{.}
\end{equation}

\end_inset

Function 
\begin_inset Formula $\hat{\mathbf{\Lambda}}\left(\cdot,\cdot\right)$
\end_inset

 is detailed Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Updating-rotation"

\end_inset

.
 The full mid-step configuration 
\begin_inset Formula $\mathbf{q}^{t+h/2}$
\end_inset

 contains some rigid and some deformable motion extrapolated from the initial
 state 
\begin_inset Formula $\mathbf{q}^{t}$
\end_inset

.
 It may have components along all of the possible deformation modes.
 The current amount of deformation is
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{d}=\left(\underline{\mathbf{I}-\mathbf{\Lambda}_{1}}\right)\mathbf{Z}+\mathbf{q}^{t+h/2}
\end{equation}

\end_inset

in the full space.
 After rotating it back to the reference configuration, it is projected
 onto the reduced base
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{q}}^{t+h/2}=\mathbf{E}^{T}\mathbf{\Lambda}_{1}^{T}\mathbf{d}\label{eq:q-proj}
\end{equation}

\end_inset

We use the full space half-step in order to produce the needed coupling
 between the rigid and deformable motions.
 This gives us the reduced configuration 
\begin_inset Formula $\bar{\mathbf{q}}^{t+h/2}$
\end_inset

 and the reduced internal force can now be computed as 
\begin_inset Formula $\bar{\mathbf{f}}_{int}^{t+h/2}=\bar{\mathbf{K}}\bar{\mathbf{q}}^{t+h/2}$
\end_inset

.
 We then write down the discrete momentum balance
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula 
\begin{equation}
\underline{\mathbf{\Lambda}}_{1}\left(\mathbf{M}+\left(\frac{\eta h}{2}+\frac{h^{2}}{4}\right)\mathbf{K}\right)\underline{\mathbf{\Lambda}}_{1}^{T}\left(\mathbf{u}^{t+h}-\mathbf{u}^{t}\right)=\mathbf{b}+\mathbf{H}^{T}\mathbf{R}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
and transform it as follows
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula 
\begin{equation}
\mathbf{E}^{T}\left(\mathbf{M}+\left(\frac{\eta h}{2}+\frac{h^{2}}{4}\right)\mathbf{K}\right)\mathbf{E}\left(\bar{\mathbf{u}}^{t+h}-\bar{\mathbf{u}}^{t}\right)=\mathbf{E}^{T}\underline{\mathbf{\Lambda}}_{1}^{T}\left(\mathbf{b}+\mathbf{H}^{T}\mathbf{R}\right)\label{eq:momproj}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
to produce a reduced system
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left(\bar{\mathbf{M}}+\left(\frac{\eta h}{2}+\frac{h^{2}}{4}\right)\bar{\mathbf{K}}\right)\left(\bar{\mathbf{u}}^{t+h}-\bar{\mathbf{u}}^{t}\right)=\mathbf{E}^{T}\underline{\mathbf{\Lambda}}_{1}^{T}\left(\mathbf{b}+\mathbf{H}^{T}\mathbf{R}\right)\mbox{.}\label{eq:redsys}
\end{equation}

\end_inset

Above, (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:momproj"

\end_inset

) is obtained by left multiplication by 
\begin_inset Formula $\mathbf{E}^{T}\underline{\mathbf{\Lambda}}_{1}^{T}$
\end_inset

, combined with an assumption that 
\begin_inset Formula $\mathbf{u}^{t+h}-\mathbf{u}^{t}=\underline{\mathbf{\Lambda}_{1}}\mathbf{E}\left(\bar{\mathbf{u}}^{t+h}-\bar{\mathbf{u}}^{t}\right)$
\end_inset

.
 As a result the reduced momentum balance reads
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{A}}\left(\bar{\mathbf{u}}^{t+h}-\bar{\mathbf{u}}^{t}\right)=\bar{\mathbf{b}}+\bar{\mathbf{H}}^{T}\mathbf{R}\label{eq:mbr}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{A}}=\bar{\mathbf{M}}+\left(\frac{\eta h}{2}+\frac{h^{2}}{4}\right)\bar{\mathbf{K}}\label{eq:Ared}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{H}}=\mathbf{H}\underline{\mathbf{\Lambda}_{1}}\mathbf{E}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{b}}=h\left(\mathbf{E}^{T}\underline{\mathbf{\Lambda}_{1}}^{T}\mathbf{f}^{t+h/2}-\bar{\mathbf{K}}\left(\bar{\mathbf{q}}^{t+h/2}+\eta\bar{\mathbf{v}}^{t}\right)\right)\label{eq:bred}
\end{equation}

\end_inset

and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{v}}^{t}=\mathbf{E}^{T}\underline{\mathbf{\Lambda}_{1}}^{T}\mathbf{u}^{t}\mbox{.}\label{eq:v0-proj}
\end{equation}

\end_inset

Note, that for the damping contribution to 
\begin_inset Formula $\bar{\mathbf{b}}$
\end_inset

 we use 
\begin_inset Formula $\bar{\mathbf{v}}^{t}$
\end_inset

 rather than 
\begin_inset Formula $\bar{\mathbf{u}}^{t}$
\end_inset

, following precisely the time integrator from the previous section.
 As before (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mbr"

\end_inset

) is solved together with the transformation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}=\bar{\mathbf{H}}\bar{\mathbf{u}}^{t+h}
\end{equation}

\end_inset

and the constraints equations
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{C}\left(\mathbf{U},\mathbf{R}\right)=\mathbf{0}\mbox{.}
\end{equation}

\end_inset

Once 
\begin_inset Formula $\bar{\mathbf{u}}^{t+h}$
\end_inset

 is known, the next full velocity and configuration read
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{u}^{t+h}=\underline{\mathbf{\Lambda}_{1}}\mathbf{E}\left(\bar{\mathbf{u}}^{t+h}-\bar{\mathbf{u}}^{t}\right)+\mathbf{u}^{t}\label{eq:u1red}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h}=\mathbf{q}^{t+h/2}+\frac{h}{2}\mathbf{u}^{t+h}\mbox{.}
\end{equation}

\end_inset

We use this configuration to update the rotation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{\Lambda}^{t+h}=\hat{\mathbf{\Lambda}}\left(\mathbf{q}^{t+h},\mathbf{\Lambda}_{1}\right)\mbox{.}\label{eq:r1red}
\end{equation}

\end_inset

Up until (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:r1red"

\end_inset

) the above scheme mimics the time integrator from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Co-rotated-stepping"

\end_inset

.
 By experimentation we notice that, when 
\begin_inset Formula $\mathbf{E}$
\end_inset

 includes only the rigid modes, the above scheme becomes strongly dissipative
 in rotational motion.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
there is a room for refinement here: both understanding and the way of describin
g
\end_layout

\end_inset

 This is not desirable: if 
\begin_inset Formula $\mathbf{E}$
\end_inset

 is reduced to rigid modes only, we would like to fall back onto an acceptable
 rigid integrator.
 We offer a simple remedy for this: we first project 
\begin_inset Formula $\mathbf{u}^{t+h}$
\end_inset

 onto reduced 
\begin_inset Formula $\bar{\mathbf{u}}^{t+h}$
\end_inset

 (overwrite it), and then resolve it back into 
\begin_inset Formula $\mathbf{u}^{t+h}$
\end_inset

 according to the non-incremental formula.
 This results in correct approximate representation of both rigid and deformable
 motions.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{\bar{u}}^{t+h}=\mathbf{E}^{T}\left(\underline{\mathbf{\Lambda}}^{t+h}\right)^{T}\mathbf{u}^{t+h}\label{eq:v1-proj}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{u}^{t+h}=\underline{\mathbf{\Lambda}}^{t+h}\mathbf{E}\mathbf{\bar{u}}^{t+h}\mbox{.}
\end{equation}

\end_inset

We then compute the final full space and reduced space configurations
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h}=\mathbf{q}^{t+h/2}+\frac{h}{2}\mathbf{u}^{t+h}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{q}}^{t+h}=\mathbf{E}^{T}\left(\underline{\mathbf{\Lambda}}^{t+h}\right)^{T}\left[\left(\underline{\mathbf{I}-\mathbf{\Lambda}^{t+h}}\right)\mathbf{Z}+\mathbf{q}^{t+h}\right]\mbox{.}\label{eq:q1red}
\end{equation}

\end_inset

Although the primary merit of developing reduced order models is in reducing
 the computational time, the smaller storage size is also a welcome consequence.
 From the above we can see that by storing 
\begin_inset Formula $\mathbf{E}$
\end_inset

, 
\begin_inset Formula $\mathbf{\Lambda}^{t}$
\end_inset

, 
\begin_inset Formula $\bar{\mathbf{u}}^{t}$
\end_inset

 and 
\begin_inset Formula $\bar{\mathbf{q}}^{t}$
\end_inset

 one can reproduce 
\begin_inset Formula $\mathbf{u}^{t}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}^{t}$
\end_inset

.
 Hence the storage size is significantly reduced.
 Although restoring 
\begin_inset Formula $\mathbf{q}^{t}$
\end_inset

 from 
\begin_inset Formula $\bar{\mathbf{q}}^{t}$
\end_inset

 is not used in the above scheme, when reading data the following procedure
 is used
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t}=\underline{\mathbf{\Lambda}}^{t}\mathbf{E}\bar{\mathbf{q}}^{t}-\left(\underline{\mathbf{I}-\mathbf{\Lambda}^{t}}\right)\mathbf{Z}\mbox{.}
\end{equation}

\end_inset

This is acceptable for the case of small co-rotated strains where in the
 initial (not co-rotated) configuration the velocities and the displacements
 belong to the same linear space.
\end_layout

\begin_layout Section
Handling constraints
\begin_inset CommandInset label
LatexCommand label
name "sec:Handling-constraints"

\end_inset


\end_layout

\begin_layout Standard
In order to compute the next step velocity a nonlinear system needs to be
 solved
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{A}\left(\mathbf{u}^{t+h}-\mathbf{u}^{t}\right)=\mathbf{b}+\mathbf{H}^{T}\mathbf{R}\label{eq:eq1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}=\mathbf{H}\mathbf{u}^{t+h}\label{eq:eq2}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{C}\left(\mathbf{U},\mathbf{R}\right)=\mathbf{0}\mbox{.}\label{eq:eq3}
\end{equation}

\end_inset

A variety of constraints can be described in the form (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:eq3"

\end_inset

).
 These include frictional contact and a range of equality constraints.
 A fixed point constraint for example reads
\begin_inset Formula 
\begin{equation}
\mathbf{C}_{\alpha}\left(\mathbf{U},\mathbf{R}\right)=\mathbf{U_{\alpha}}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{U}_{\alpha}$
\end_inset

 is the 3-component local velocity of a point indexed by 
\begin_inset Formula $\alpha$
\end_inset

.
 An example of solving the system (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:eq1"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:eq3"

\end_inset

) in case of frictional contact constraints can be found in 
\begin_inset CommandInset citation
LatexCommand citep
key "Jean01,Moreau01,Koziara2008"

\end_inset

, while a broader overview can be found in 
\begin_inset CommandInset citation
LatexCommand citep
key "BrogliatoBook,Acary2008"

\end_inset

.
 In the examples section below we use the frictional contact formulation
 detailed in 
\begin_inset CommandInset citation
LatexCommand citep
key "Jean01,Koziara2010"

\end_inset

.
\end_layout

\begin_layout Standard
In practice it is sometimes convenient to reformulate the algebra of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:eq1"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:eq2"

\end_inset

) so that only constraints space variables are used.
 This is done by eliminating 
\begin_inset Formula $\mathbf{u}^{t+h}$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}=\mathbf{H}\mathbf{A}^{-1}\left(\mathbf{b}+\mathbf{H}^{T}\mathbf{R}\right)
\end{equation}

\end_inset

or
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}=\mathbf{WR}+\mathbf{B}\mbox{.}
\end{equation}

\end_inset


\begin_inset Formula $\mathbf{W}$
\end_inset

 is a symmetric semi-positive definite operator composed of dense 
\begin_inset Formula $3\times3$
\end_inset

 blocks.
 It's sparsity structure depends on topological connectivity of constraints.
 For typical multibody problems the number of constraints usually exceeds
 the number of available kinematic freedom.
 In such cases constraint solvers usually require many iterations (e.g.
 of a nonlinear Gauss-Seidel scheme) to achieve reasonable accuracy.
 In many such cases it is more efficient to explicitly compute 
\begin_inset Formula $\mathbf{W}$
\end_inset

.
 In our case we have either
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{W}=\mathbf{H}\underline{\mathbf{\Lambda}_{1}}\mathbf{A}_{0}^{-1}\underline{\mathbf{\Lambda}_{1}}^{T}\mathbf{H}^{T}\label{eq:W1}
\end{equation}

\end_inset

where we should first compute 
\begin_inset Formula $\mathbf{H}_{1}=\mathbf{H}\underline{\mathbf{\Lambda}_{1}}$
\end_inset

 and then 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\mathbf{H}_{1}^{T}\mathbf{A}_{0}^{-1}\mathbf{H}_{1}^{T}$
\end_inset

, using a fixed factorization of 
\begin_inset Formula $\mathbf{A}_{0}^{-1}$
\end_inset

; or we have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{W}=\bar{\mathbf{H}}\bar{\mathbf{A}}^{-1}\bar{\mathbf{H}}^{T}\label{eq:W2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\bar{\mathbf{H}}=\mathbf{H}\underline{\mathbf{\Lambda}_{1}}\mathbf{E}$
\end_inset

 is small and dense, while 
\begin_inset Formula $\bar{\mathbf{A}}^{-1}$
\end_inset

 can be precomputed and stored as an explicit inverse.
\end_layout

\begin_layout Section
Impacts, friction and energy 
\begin_inset CommandInset label
LatexCommand label
name "sec:Impacts"

\end_inset


\end_layout

\begin_layout Standard
In the next section we present several examples involving impacts and friction.
 To model impacts we use the velocity level Signorini condition
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
U_{N}^{t+h}\ge0,\,R_{N}\ge0,\,U_{N}^{t+h}R_{N}=0\label{eq:Signorini}
\end{equation}

\end_inset

where 
\begin_inset Formula $U_{N}^{t+h}$
\end_inset

 is the normal component of the relative contact point velocity, and 
\begin_inset Formula $R_{N}$
\end_inset

 is the normal component of the reaction impulse.
 To model friction we use Coulomb's law
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \begin{array}{ll}
\left\Vert \mathbf{R}_{T}\right\Vert \le\mu R_{N}\\
\left\Vert \mathbf{R}_{T}\right\Vert <\mu R_{N} & \Rightarrow\mathbf{U}_{T}^{t+h}=\mathbf{0}\\
\left\Vert \mathbf{R}_{T}\right\Vert =\mu R_{N} & \Rightarrow\exists_{\lambda\ge0}\mathbf{U}_{T}^{t+h}=-\lambda\mathbf{R}_{T}
\end{array}\right.\label{eq:Coulomb}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{U}_{T}$
\end_inset

 is the tangential component of the relative contact point velocity, 
\begin_inset Formula $\mathbf{R}_{T}$
\end_inset

 is the tangential component of the reaction impulse, and 
\begin_inset Formula $\mu$
\end_inset

 is the Coulomb's coefficient of friction.
 The above two laws can be rewritten as 
\begin_inset Formula $\mathbf{C}\left(\mathbf{U},\mathbf{R}\right)=\mathbf{0}$
\end_inset

 
\begin_inset CommandInset citation
LatexCommand citep
key "Jean01"

\end_inset

, as used in the previous sections.
 Such combined interface law should not inject energy into a multibody system.
 An analysis of energetic consistency aims at ensuring that the increment
 of the total system energy is semi-negative 
\begin_inset Formula 
\begin{equation}
\mathbf{E}_{tot}^{t+h}-\mathbf{E}_{tot}^{t}\le0\mbox{.}
\end{equation}

\end_inset

As already mentioned in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Total-Lagrangian"

\end_inset

, our integration schemes do not guarantee energy conservation and hence
 ensuring the above is not possible.
 At most we can show that conditions (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Signorini"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Coulomb"

\end_inset

) do not additionally inject energy into the integrated system.
 Assuming no external loading, in the presence of contacts the total energy
 increment can be approximated as
\begin_inset Formula 
\begin{equation}
\mathbf{E}_{tot}^{t+h}-\mathbf{E}_{tot}^{t}\simeq\triangle W
\end{equation}

\end_inset

where 
\begin_inset Formula $\triangle W$
\end_inset

 is an increment of the work of the contact reactions.
 In our time integration we can start by making the first half-step
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{0+h/2}=\mathbf{q}^{0}+\frac{h}{2}\mathbf{u}^{0}
\end{equation}

\end_inset

and then continue with updates
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+3h/2}=\mathbf{q}^{t+h/2}+h\mathbf{u}^{t+h}\mbox{.}
\end{equation}

\end_inset

A configuration increment reads then
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\triangle\mathbf{q}=\mathbf{q}^{t+3h/2}-\mathbf{q}^{t+h/2}=h\mathbf{u}^{t+h}\mbox{.}
\end{equation}

\end_inset

If we transform this increment into the contact points space
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\triangle\mathbf{Q}=\mathbf{H}\triangle\mathbf{q}=h\mathbf{U}^{t+h}
\end{equation}

\end_inset

we are able to see that contact forces produce the following work increment
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\triangle W=h\left\langle \mathbf{U}^{t+h},\mathbf{R}\right\rangle =\triangle W_{T}+\triangle W_{N}=h\left\langle \mathbf{U}_{T}^{t+h},\mathbf{R}_{T}\right\rangle +h\left\langle U_{N}^{t+h},R_{N}\right\rangle \mbox{.}
\end{equation}

\end_inset

Since the Coulomb's law ensures 
\begin_inset Formula $\triangle W_{T}\le0$
\end_inset

 and the Signorini condition gives 
\begin_inset Formula $\triangle W_{N}=0$
\end_inset

 , we and up with 
\begin_inset Formula $\triangle W\le0$
\end_inset

, so that conditions (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Signorini"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Coulomb"

\end_inset

) are dissipative.
\end_layout

\begin_layout Section
Examples
\begin_inset CommandInset label
LatexCommand label
name "sec:Examples"

\end_inset


\end_layout

\begin_layout Standard
We present three examples.
 The first example (Rotating bar) overviews the most basic properties of
 the proposed formulations.
 The second example (Pipe impact) demonstrates performance on a simple impact
 problem.
 The third example (Array excitation) applies the proposed schemes to a
 structural multi-body setup where some experimental results are available.
\end_layout

\begin_layout Subsection
Rotating bar
\end_layout

\begin_layout Standard
A prismatic bar with 
\begin_inset Formula $x,y,z$
\end_inset

 dimensions 
\begin_inset Formula $0.1\times0.1\times1\mbox{ m}$
\end_inset

 and material parameters 
\begin_inset Formula $E\in\left\{ 200\mbox{E4 Pa},200\mbox{E9 Pa}\right\} $
\end_inset

, 
\begin_inset Formula $\nu=0.26,\rho=7.8\mbox{E3 kg /}\mbox{m}^{3}$
\end_inset

 is rotating about the 
\begin_inset Formula $x$
\end_inset

-axis with an initial angular velocity of 
\begin_inset Formula $1\mbox{ rad/s}$
\end_inset

.
 We use the smaller Young's modulus in most demonstrations since in this
 case the time scales of the rigid and deformable motions are not far apart.
 For 
\begin_inset Formula $E=200\mbox{E9 Pa}$
\end_inset

 the material parameters correspond to steel.
 In this case the time scale of elastic deformations is much faster then
 that of the rigid rotation.
 We use this material to test performance of the proposed integrators when
 applied with large time steps.
 In what follows, unless stated otherwise, the value 
\begin_inset Formula $E=200\mbox{E4}$
\end_inset

 is used by default.
\end_layout

\begin_layout Standard
The bar is discretized with 
\begin_inset Formula $2\times2\times20$
\end_inset

 fully integrated trilinear hexahedral elements, Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RB1"

\end_inset

.
 This results in 
\begin_inset Formula $576$
\end_inset

 degrees of freedom for the full order model.
 For the reduced order BC-RO approach we used 100 co-rotated displacement
 samples from the Total Lagrangian solution (with rigid rotation factored
 out) and 6 rigid motion modes (generated algebraically) as input for the
 
\begin_inset CommandInset href
LatexCommand href
name "Python modred package"
target "http://pythonhosted.org/modred/"

\end_inset

, and calculated 11 Proper Orthogonal Decomposition modes.
 In the current example, we also include the approach from Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BC-MODAL"

\end_inset

, for which the 6 rigid modes where combined with deformable modes 14, 19,
 26, 34, 39 (of the initial linearized system), picked by hand as visually
 corresponding to the predominantly longitudinal deformation of the bar.
 Hence, the BC-MODAL case also had 
\begin_inset Formula $11$
\end_inset

 degrees of freedom.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro0_mesh.png
	lyxscale 50
	height 18pheight%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RB1"

\end_inset

Rotating bar: geometry of the 
\begin_inset Formula $2\times2\times20$
\end_inset

 mesh.
\end_layout

\end_inset


\end_layout

\end_inset

We first compare the solutions for damped and undamped cases.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RB2"

\end_inset

 illustrates the time history of the elongation of the bar, measured between
 the top and bottom center nodes, for undamped 
\begin_inset Formula $1\mbox{s}$
\end_inset

 runs with time steps 
\begin_inset Formula $h\in\left\{ 1/64\mbox{s},1/256\mbox{s}\right\} $
\end_inset

.
 It can be seen that the results compare well between the formulations proposed
 here and the Total Lagrangian approach integrated in an analogous manner.
 A damped case is illustrated in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RB3"

\end_inset

 for the large time step of 
\begin_inset Formula $h=1/64\mbox{s}$
\end_inset

.
 Also in this case the agreement is good.
 The Total Lagrangian based solution deviates from the co-rotational solution
 since for the TL the stiffness matrix magnitude changes with configuration,
 which affects the stiffness proportional damping.
 We can conclude the 5 deformable modes used by the BC-RO and BC-MODAL approache
s represent well the longitudinal oscillation accompanying the rotational
 motion of the bar.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro0_elongation_h64_d0.png
	lyxscale 35
	width 50text%

\end_inset


\begin_inset Graphics
	filename ro0_elongation_h256_d0.png
	lyxscale 35
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RB2"

\end_inset

Undamped rotating bar: time history of the elongation for 
\begin_inset Formula $h\in\left\{ 1/64\mbox{s},1/256\mbox{s}\right\} $
\end_inset

 and 
\begin_inset Formula $1\mbox{s}$
\end_inset

 runs.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro0_elongation_h64_d0.01.png
	lyxscale 35
	width 50text%

\end_inset


\begin_inset Graphics
	filename ro0_elongation_h64_d0.05.png
	lyxscale 35
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RB3"

\end_inset

Damped rotating bar: time history of the elongation for 
\begin_inset Formula $h=1/64\mbox{s}$
\end_inset

, 
\begin_inset Formula $\eta\in\left\{ 0.01,0.05\right\} $
\end_inset

 and 
\begin_inset Formula $1\mbox{s}$
\end_inset

 runs.
\end_layout

\end_inset


\end_layout

\end_inset

Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RB4"

\end_inset

 illustrates the time history of the total energy of the bar for 100s runs
 with time steps 
\begin_inset Formula $h\in\left\{ 1/64\mbox{s},1/256\mbox{s}\right\} $
\end_inset

.
 For all but the BC-RO approach, the small oscillation of energy remains
 bounded with time.
 The full space co-rotational BC approach is better behaved than BC-MODAL:
 in nearly coincides with the Total Lagrangian approach.
 The relatively small oscillation of energy, present in TL, BC, and BC-MODAL
 cases, is characteristic for the adopted time stepping and it has been
 also demonstrated by Zhang and Skeel 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang1997"

\end_inset

 on simpler model problems.
 The larger oscillation and dissipation of energy, clear in case of the
 BC-RO approach, remains a shortcoming and it may be addressed in future
 revisions of this paper.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro0_energy_h64_d0_100s.png
	lyxscale 30
	width 50text%

\end_inset


\begin_inset Graphics
	filename ro0_energy_h256_d0_100s.png
	lyxscale 30
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RB4"

\end_inset

Rotating bar: time history of total energy for 
\begin_inset Formula $h\in\left\{ 1/64\mbox{s},1/256\mbox{s}\right\} $
\end_inset

 and 
\begin_inset Formula $100\mbox{s}$
\end_inset

 runs.
\end_layout

\end_inset


\end_layout

\end_inset

The second order convergence rate is illustrated in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:RB5"

\end_inset

.
 Two cases are considered: undamped motion of a soft bar 
\begin_inset Formula $E=200\mbox{E4}$
\end_inset

 and damped motion of stiff bar 
\begin_inset Formula $E=200\mbox{E9}$
\end_inset

.
 In both cases the reference solution 
\begin_inset Formula $q_{ref}$
\end_inset

 was obtained at time 
\begin_inset Formula $t=1/2^{4}\mbox{s}$
\end_inset

 with time step 
\begin_inset Formula $h=1/2^{16}\mbox{s}$
\end_inset

.
 For the softer material the time scales of the rigid and deformable motion
 are not far apart and hence it is easier to observe the second order convergenc
e for larger time steps.
 For the stiffer model we used damping 
\begin_inset Formula $\eta=1/10^{6}$
\end_inset

 in order to damp out the high frequency oscillations that could not be
 well represented for the large time steps used here.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro0_convtest_undamped_E200E4.png
	lyxscale 35
	width 50text%

\end_inset


\begin_inset Graphics
	filename ro0_convtest_damped_E200E9.png
	lyxscale 35
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:RB5"

\end_inset

Rotating bar: second order convergence of displacements for soft undamped
 (
\begin_inset Formula $E=200\mbox{E4, }\eta=0$
\end_inset

) and stiff damped (
\begin_inset Formula $E=200\mbox{E9, }\eta=1/10^{6}$
\end_inset

) materials.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Pipe impact
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro1_pipe0.png
	lyxscale 20
	width 29text%

\end_inset


\begin_inset Graphics
	filename ro1_pipe1.png
	lyxscale 20
	width 29text%

\end_inset


\begin_inset Graphics
	filename ro1_pipe2.png
	lyxscale 20
	width 29text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:PI0A"

\end_inset

Pipe impact: initial, impact, and final configurations (left to right).
\end_layout

\end_inset


\end_layout

\end_inset

An elastic pipe free falls onto a block obstacle.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PI0A"

\end_inset

 illustrates the initial, impact and final configurations.
 The inner pipe radius is 0.01 m, its thickness is 0.005 m, and its length
 is 0.1 m.
 The pipe lowest point is initially located 0.025 m above the top surface
 of the block.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PI0B"

\end_inset

 shows the characteristic points, used to extract results.
 Point p0 impacts the geometrical center of the block.
 Points p0, p1, p2, p3 are 0.025 m away from p4, when measuring along the
 pipe length.
 The pipe is made of 
\begin_inset Formula $36\times36\times4$
\end_inset

 fully integrated trilinear hexahedral elements.
 The elastic properties of the pipe are 
\begin_inset Formula $E=1\mbox{E7 Pa}$
\end_inset

, 
\begin_inset Formula $\nu=0.25$
\end_inset

 and its density is 
\begin_inset Formula $\rho=1\mbox{E3 kg /}\mbox{m}^{3}$
\end_inset

.
 The obstacle has dimensions 
\begin_inset Formula $0.01\times0.1\times0.01\mbox{ m}$
\end_inset

 and it is modeled as a geometrical boundary which does not contribute mass.
 The gravity along the 
\begin_inset Formula $z$
\end_inset

-direction is 
\begin_inset Formula $-10\text{ m/s}^{2}$
\end_inset

.
 The simulation time step is 0.001 s, the duration is 0.1 s, and the amount
 of damping is 
\begin_inset Formula $\eta=1\text{E-4}$
\end_inset

.
 Schemes TL, BC, and BC-RO are compared.
 100 co-rotated displacement samples from the Total Lagrangian solution
 and 6 rigid motion modes are used as input for the 
\begin_inset CommandInset href
LatexCommand href
name "Python modred package"
target "http://pythonhosted.org/modred/"

\end_inset

, to produce 18 Proper Orthogonal Decomposition modes for the BC-RO approach.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro1_points.png
	lyxscale 20
	width 45text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:PI0B"

\end_inset

Pipe impact: mesh characteristic points.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PI1"

\end_inset

 illustrates the energy balance: in all cases the graphs coincide relatively
 well.
 While the BC approach closely follows the Total Lagrangian approach (TL),
 the reduced order BC-RO approach slightly deviates in its post-impact response.
 Similar general response characteristic can be seen in Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PI2"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PI3"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PI4"

\end_inset

 where other types of results are compared: we have some variation in the
 post-impact response, while overall the results match.
 We note, that the rotation angle in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:PI2"

\end_inset

 was calculated using
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\text{angle}=\arcsin\left(\frac{\text{p5}-\text{p4}}{\left|\text{p5}-\text{p4}\right|}\times\left(-1,0,0\right)\right)\text{.}
\]

\end_inset

Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:PI1"

\end_inset

 illustrates the runtime and storage statistics.
 The body co-rotational (BC) approach is about 6 times faster than TL; the
 reduced order (BC-RO) approach is about 50 time faster and requires about
 50 times less storage.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro1_kin_energy.png
	lyxscale 35
	width 50text%

\end_inset


\begin_inset Graphics
	filename ro1_int_energy.png
	lyxscale 35
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:PI1"

\end_inset

Pipe impact: kinetic (left), and internal energy between 
\begin_inset Formula $t=0.05\text{s}$
\end_inset

 and 
\begin_inset Formula $t=0.1\text{s}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro1_p4z_p5z.png
	lyxscale 35
	width 50text%

\end_inset


\begin_inset Graphics
	filename ro1_rotation.png
	lyxscale 35
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:PI2"

\end_inset

Pipe impact: z-coordinates of points p4, p5 (left), and pipe rotation angle
 (about 
\begin_inset Formula $y$
\end_inset

) between 
\begin_inset Formula $t=0.05\text{s}$
\end_inset

 and 
\begin_inset Formula $t=0.1\text{s}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro1_inner_diameter.png
	lyxscale 35
	width 50text%

\end_inset


\begin_inset Graphics
	filename ro1_outer_diameter.png
	lyxscale 35
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:PI3"

\end_inset

Pipe impact: inner 
\begin_inset Formula $\left|\text{p2}-\text{p3}\right|$
\end_inset

 (left), and outer 
\begin_inset Formula $\left|\text{p0}-\text{p1}\right|$
\end_inset

 pipe diameter in the contact area between 
\begin_inset Formula $t=0.05\text{s}$
\end_inset

 and 
\begin_inset Formula $t=0.1\text{s}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename ro1_p0mises.png
	lyxscale 35
	width 50text%

\end_inset


\begin_inset Graphics
	filename ro1_p2mises.png
	lyxscale 35
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:PI4"

\end_inset

Pipe impact: inner point p0 (left), and outer point p2 MISES stress between
 
\begin_inset Formula $t=0.05\text{s}$
\end_inset

 and 
\begin_inset Formula $t=0.1\text{s}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Formulation
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
TL
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
BC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
BC-RO
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Runtime [s]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
101
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16.2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2.0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Storage [MB]
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
13
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
13
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.264
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:PI1"

\end_inset

Pipe impact: runtime and storage comparison
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
TODO:
\end_layout

\begin_layout Itemize
effect of damping
\end_layout

\begin_layout Itemize
effect of time step
\end_layout

\begin_layout Itemize
these could be studied in a separate technical report
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Array excitation
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename 81rig.png
	lyxscale 40
	height 39text%

\end_inset


\begin_inset Graphics
	filename 81mesh.png
	lyxscale 20
	height 49text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:81bricks1"

\end_inset

81 brick array: experimental setup (left) and meshed model (right: base
 mesh).
\end_layout

\end_inset


\end_layout

\end_inset

The experiment behind this example comes from the context of the civil nuclear
 power generation in the UK.
 A series of dynamic tests were carried out by National Nuclear Corporation
 in 1985 as part of the seismic endorsement of the Heysham II / Torness
 AGR
\begin_inset Foot
status open

\begin_layout Plain Layout
AGR stands for an Advanced Gass-cooled Reactor
\end_layout

\end_inset

 core design.
 These tests used an array of 81 graphite bricks as shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:81bricks1"

\end_inset

 (left), consisting of alternating ‚Äòfuel‚Äô and ‚Äòinterstitial‚Äô bricks.
 The array was mounted in a rigid frame on a shaker table.
 The boundary frame was driven in the horizontal plane with synthesized
 seismic or swept-sine input motions in either one or both axes simultaneously.
 Measurements were taken of the resulting velocities of certain bricks in
 the array (determined from accelerometer data) and also of the forces within
 the keying system (using load cells built into some components).
 Some details of the experimental setup has been described in 
\begin_inset CommandInset citation
LatexCommand citep
key "Ahmed1987a,Ahmed1987b"

\end_inset

.
 We note, that this example is also called the 
\begin_inset Quotes eld
\end_inset

81 brick array
\begin_inset Quotes erd
\end_inset

, or simply the 
\begin_inset Quotes eld
\end_inset

81 array
\begin_inset Quotes erd
\end_inset

, because the total number of unconstrained fuel and interstitial bricks
 is 81.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
Fuel-fuel bricks coefficients of restitution are in C33-C34-PSD-213-086
 report, page 59.
 CS grade graphite used in the binary test (what is 
\begin_inset Quotes eld
\end_inset

CS
\begin_inset Quotes erd
\end_inset

?) and the full array sweeps.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename 81module.png
	lyxscale 33
	height 20pheight%

\end_inset


\begin_inset Graphics
	filename 81fbi.png
	lyxscale 42
	height 20pheight%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:81bricks2"

\end_inset

81 brick array: array module closeup (left: base mesh) and the binary impact
 test (right: fine mesh).
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In the current demonstration we bypass many of the details of our mechanical
 model.
 The ultimate aim is modeling the entire AGR core (
\begin_inset Formula $\sim5\text{K}$
\end_inset

 fuel bricks), hence we are in the search for the lowest possible resolution
 model.
 We are going to demonstrate some results for two mesh densities: denoted
 as a 
\begin_inset Quotes eld
\end_inset

basic mesh
\begin_inset Quotes erd
\end_inset

 and a 
\begin_inset Quotes eld
\end_inset

fine mesh
\begin_inset Quotes erd
\end_inset

, cf.
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:81stats"

\end_inset

.
 The basic meshed model is presented in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:81bricks1"

\end_inset

 (right).
 As in the experiment all bodies are vertically restrained so that they
 move in a frictionless manner in the horizontal plane.
 Since the behavior of the assembly is essentially two dimensional the number
 of elements along the height is kept to minimum.
 In Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:81bricks2"

\end_inset

 one can see that the number of elements used in the horizontal brick sections
 is also small.
 For fuel brick meshes the error in the lowest eigenmodes corresponding
 to planar squeezing is below 35% (as compared with finer meshes), which
 we tentatively accept in the quest for a lowest possible resolution model.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="7">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Fuel brick
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Interstitial brick
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Loose key
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Model total
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
BC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
base mesh
\end_layout

\end_inset
</cell>
<cell multirow="3" alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
DOFs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
432
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
456
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
56112
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fine mesh
\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1512
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
456
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
121992
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
BC-RO
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
base mesh
\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10144
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
fine mesh
\end_layout

\end_inset
</cell>
<cell multirow="4" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10144
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:81stats"

\end_inset

Base and fine mesh statistics: there are 61 fuel bricks, 60 interstitial
 bricks, and 100 loose keys in each case.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The following material parameters were assumed for the graphite used in
 the experiment: 1.18E10Pa for Young's modulus, 0.21 for Poisson's ratio,
 and for mass density 1688kg/
\begin_inset Formula $\mbox{m}^{3}$
\end_inset

, 1637kg/
\begin_inset Formula $\mbox{m}^{3}$
\end_inset

, 1740kg/
\begin_inset Formula $\mbox{m}^{3}$
\end_inset

 for respectively fuel bricks, interstitial bricks and loose keys (the mass
 densities were tuned to obtain the total brick weights reported in the
 experiment).
 The coefficient of Coulomb's friction was assumed 0.1.
 Among several simple impact tests performed in the preliminary experimental
 work, a binary impact between fuel bricks was pursued: Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:81bricks2"

\end_inset

 (right).
 A range of relative input velocities was used (5-35 cm/s) for which the
 ratio of the output velocity to the input velocity remained consistently
 in the area of 0.9.
 It should be noted that due to geometrical setup, this particular type
 of impact is not present in our full array model.
 We then have two independent experiments, which we try to validate simultaneous
ly.
\end_layout

\begin_layout Standard
We use three families of models: solely rigid (RG), body co-rotational (BC),
 and reduced order (BC-RO).
 In all cases the time step is 0.0001s.
 Co-rotated displacements from the BC simulation were sampled at 0.02s intervals
 and together with the 6 algebraically generated rigid modes, for each distinct
 mesh instance, served as an input for the 
\begin_inset CommandInset href
LatexCommand href
name "Python modred package"
target "http://pythonhosted.org/modred/"

\end_inset

, to produce POD bases for the BC-RO approach: 64 modes were used for both
 the fuel and the interstitial bricks.
 The loose keys were modeled as single elements based on the co-rotated
 BC approach.
 For the deformable models we used damping 
\begin_inset Formula $\eta=\mbox{1E-7}$
\end_inset

, which, for the finer mesh, roughly reproduced the required macroscopic
 velocity restitution of 0.9 for the binary impact test from Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:81bricks2"

\end_inset

 (right): restitution of 0.91 was produced by the BC approach, and 0.86 by
 BC-RO.
 For the basic mesh, the reproduced coefficient of restitution was 0.85 for
 the BC approach, and 0.82 for BC-RO.
 In case of the rigid body model the impact restitution was zero, resulting
 in a totally passive response.
\end_layout

\begin_layout Standard
In the initial validation of the entire array model we aimed at reproducing
 a swept-sine constant amplitude acceleration test.
 In the experiment the array was subject to a 3s 3Hz settling dwell at start,
 followed by a 3Hz to 10Hz sweep with 0.1Hz/s buildup rate and constant amplitude
 of 0.3g, all this amounting to the total duration of 72s.
 The sweep direction was aligned with one of the sides of the array.
 Linear velocity histories of the centre points of several bricks were recorded
 at 50Hz
\begin_inset Note Note
status open

\begin_layout Plain Layout
500Hz originally: too large output files
\end_layout

\end_inset

.
 Magnitudes of these velocities were then averaged using 0.1Hz window and
 plotted as time series normalized by the corresponding magnitudes of the
 input velocity.
\end_layout

\begin_layout Standard
The input acceleration signal produces a smoothly decaying envelope of displacem
ent, which given a fixed amount of clearance between bricks, initially builds
 up their 
\begin_inset Quotes eld
\end_inset

rattling
\begin_inset Quotes erd
\end_inset

 interactions and then passes a threshold beyond which interactions cease.
 Initially the displacements are much larger than the clearance and the
 entire array is swept back and forth.
 When the boundary displacements reach the level of the clearance (few mm)
 the kinetic energy starts being injected into higher modes of the system.
 This builds up a peak in the velocity response.
 When the input displacements fall below the clearance distance the bricks
 disengage and there is a drop in the velocity response.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename 81velo_BC.png
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:81bricks3"

\end_inset

81 brick array: frequency histories of normalized output velocity magnitudes.
 EXP is the experiment.
 BC-base and BC-fine denote the body co-rotational formulation using respectivel
y the base and the fine mesh.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename 81velo_BC_RO_base.png
	width 80text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:81bricks4"

\end_inset

81 brick array: frequency histories of normalized output velocity magnitudes.
 EXP is the experiment.
 BC-base and RO-base are respectively the BC and the BC-RO formulations,
 both using the base mesh.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO:
\end_layout

\begin_layout Itemize
BC, BC-RO, rigid
\end_layout

\begin_layout Itemize
BC ‚Äì> modes for BC-RO
\end_layout

\begin_layout Itemize
compare response profiles
\end_layout

\begin_layout Itemize
runtime and storage
\end_layout

\begin_layout Itemize
REGISTER_BASE () - may be helpful
\end_layout

\end_inset


\begin_inset Note Note
status open

\begin_layout Subsection
Ellipsoids compaction
\end_layout

\begin_layout Plain Layout
TODO:
\end_layout

\begin_layout Itemize
Revision 2 example
\end_layout

\begin_layout Itemize
quasi-static: zero 
\begin_inset Formula $\mathbf{u}^{t+h}$
\end_inset

 velocity after every step
\end_layout

\begin_layout Itemize
100 ellipsoids BC: modes for BC-RO (1 friction level)
\end_layout

\begin_layout Itemize
100 ellipsoids BC, BC-RO: stress and displacement Eulerian cross-sections
 (1 friction level)
\end_layout

\begin_layout Itemize
10k ellipsoids: parallel scaling, stress cross-sections for 3 friction levels
\end_layout

\begin_layout Itemize
REGISTER_BASE () - will definitely be helpful
\end_layout

\end_inset


\end_layout

\begin_layout Section
Conclusions
\begin_inset CommandInset label
LatexCommand label
name "sec:Conclusions"

\end_inset


\end_layout

\begin_layout Section
\start_of_appendix
Appendix - Updating rotation 
\begin_inset CommandInset label
LatexCommand label
name "sec:Updating-rotation"

\end_inset


\end_layout

\begin_layout Standard
Kaczmarczyk et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Kaczmarczyk2012"

\end_inset

 developed a convenient way of updating rotation, as needed in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:L1"

\end_inset

), and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:L2"

\end_inset

).
 Because the antisymmetric part of the gradient of the deformational displacemen
t (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:defo1"

\end_inset

) corresponds to an infinitesimal rotation at a point, a sum
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\overline{\nabla\mathbf{d}}=\int_{\Omega}\nabla\mathbf{d}\left(\mathbf{X},t\right)-\nabla\mathbf{d}^{T}\left(\mathbf{X},t\right)d\Omega
\end{equation}

\end_inset

represents the resultant infinitesimal rotation of the body, where the 
\begin_inset Formula $1/2$
\end_inset

 term, being non-consequential to our derivation, has been skipped.
 For every 
\begin_inset Formula $\mathbf{d}$
\end_inset

, 
\begin_inset Formula $\mathbf{\Lambda}$
\end_inset

 is incremented in such a way so to minimise 
\begin_inset Formula $\overline{\nabla\mathbf{d}}$
\end_inset

.
 The divergence theorem is exploited in 
\begin_inset CommandInset citation
LatexCommand citep
key "Kaczmarczyk2012"

\end_inset

 in order to obtain
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mbox{vec}\left[\int_{\Omega}\nabla\mathbf{d}-\nabla\mathbf{d}^{T}d\Omega\right]=\int_{\Gamma}\mathbf{n}\times\mathbf{d}d\Gamma
\end{equation}

\end_inset

where 
\begin_inset Formula $\mbox{vec\left[\cdot\right]}$
\end_inset

 makes a pseudo-vector out of an antisymmetric matrix, and 
\begin_inset Formula $\mathbf{n}$
\end_inset

 is the spatial outward normal to the surface 
\begin_inset Formula $\Gamma$
\end_inset

 of the body 
\begin_inset Formula $\Omega$
\end_inset

.
 The surface integral can be further resolved
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\mathbf{h} & = & \int_{\Gamma}\mathbf{n}\times\mathbf{d}d\Gamma=\int_{\Gamma}\mbox{skew}\left[\mathbf{n}\right]\mathbf{d}d\Gamma\nonumber \\
 & = & \int_{\Gamma}\mbox{skew}\left[\mathbf{\Lambda}\mathbf{N}\right]\mathbf{d}d\Gamma=\int_{\Gamma}\mbox{skew}\left[\mathbf{N}\right]\mathbf{\Lambda}^{T}\mathbf{d}d\Gamma\nonumber \\
 & = & \int_{\Gamma}\mbox{skew}\left[\mathbf{N}\right]\mathbf{\Lambda}^{T}\left[\mathbf{X}+\mathbf{S}\left(\mathbf{X}\right)\mathbf{q}-\mathbf{\Lambda}\mathbf{X}\right]d\Gamma\nonumber \\
 & \simeq & \int_{\Gamma_{0}}\mbox{skew}\left[\mathbf{N}\right]\mathbf{X}d\Gamma_{0}+\int_{\Gamma}\mbox{skew}\left[\mathbf{N}\right]\mathbf{\Lambda}^{T}\left[\mathbf{X}+\mathbf{S}\left(\mathbf{X}\right)\mathbf{q}\right]d\Gamma\nonumber \\
 & = & \int_{\Gamma}\mbox{skew}\left[\mathbf{N}\right]\mathbf{\Lambda}^{T}\mathbf{x}d\Gamma\label{eq:h}
\end{eqnarray}

\end_inset

where the simplification to the last line follows from the assumption 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\int_{\Gamma}fd\Gamma\simeq\int_{\Gamma_{0}}fd\Gamma_{0}$
\end_inset

 and from the
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
 fact that 
\begin_inset Formula $\int_{\Gamma}\mbox{skew}\left[\mathbf{N}\right]\mathbf{X}d\Gamma=\mbox{vec}\left[\int_{\Omega}\nabla\mathbf{X}-\nabla\mathbf{X}^{T}d\Omega\right]=\mathbf{0}$
\end_inset

, where 
\begin_inset Formula $\mathbf{N}$
\end_inset

 is the surface normal field in the reference configuration and 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\Gamma_{0}$
\end_inset

 is the referential surface
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
.
 The operator 
\begin_inset Formula $\mbox{skew}\left[\cdot\right]$
\end_inset

 furnishes a skew symmetric matrix out of a vector so that 
\begin_inset Formula $\mbox{skew}\left[\mathbf{n}\right]\mathbf{d}=\mathbf{n}\times\mathbf{d}$
\end_inset

.
 The following functional is then defined
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{J}\left(\mathbf{q},\mathbf{\Lambda}\right)=\frac{1}{2}\mathbf{h}^{T}\left(\mathbf{q},\mathbf{\Lambda}\right)\mathbf{h}\left(\mathbf{q},\mathbf{\Lambda}\right)
\end{equation}

\end_inset

and the 
\begin_inset Formula $\hat{\mathbf{\Lambda}}$
\end_inset

 mapping employed in the previous section takes form
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\hat{\mathbf{\Lambda}}\left(\mathbf{q},\mathbf{\Lambda}\right)=\exp\left(\mathbf{\Phi}\right)\mathbf{\Lambda}\mbox{, where }\mathbf{\Phi}=\arg\min\mathbf{J}\left(\mathbf{q},\exp\left(\mathbf{\Phi}\right)\mathbf{\Lambda}\right)
\end{equation}

\end_inset

where 
\begin_inset Formula $\exp\left[\cdot\right]$
\end_inset

 is the exponential map.
 Gauss-Newton iterations are exploited in order to compute the minimiser
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{\Phi}^{i+1}=\mathbf{\Phi}^{i}-\left\{ \partial^{2}\mathbf{J}/\partial\mathbf{\Phi}\partial\mathbf{\Phi}\right\} ^{-1}\left\{ \partial\mathbf{J}/\partial\mathbf{\Phi}\right\} \label{eq:newton}
\end{equation}

\end_inset

where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\partial\mathbf{J}/\partial\mathbf{\Phi} & = & \mathbf{h}^{T}\left[\partial\mathbf{h}/\partial\mathbf{\Phi}\right]\nonumber \\
 & = & \mathbf{h}^{T}\left[\int_{\Gamma}\mbox{skew}\left[\mathbf{N}\right]\mathbf{\Lambda}^{T}\frac{\partial\exp\left(-\mathbf{\Phi}\right)}{\partial\mathbf{\Phi}}\mathbf{x}d\Gamma\right]\label{eq:dJdf}
\end{eqnarray}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray}
\partial^{2}\mathbf{J}/\partial\mathbf{\Phi}\partial\mathbf{\Phi} & = & \left[\partial\mathbf{h}/\partial\mathbf{\Phi}\right]^{T}\left[\partial\mathbf{h}/\partial\mathbf{\Phi}\right]+\mathbf{h}^{T}\left[\partial^{2}\mathbf{h}/\partial\mathbf{\Phi}\partial\mathbf{\Phi}\right]\nonumber \\
 & \simeq & \left[\partial\mathbf{h}/\partial\mathbf{\Phi}\right]^{T}\left[\partial\mathbf{h}/\partial\mathbf{\Phi}\right]+\delta\mathbf{I}\label{eq:ddJdfdf}
\end{eqnarray}

\end_inset

and 
\begin_inset Formula $\delta$
\end_inset

 is large enough to make 
\begin_inset Formula $\partial^{2}\mathbf{J}/\partial\mathbf{\Phi}\partial\mathbf{\Phi}$
\end_inset

 positive definite, ensuring a descent direction in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:newton"

\end_inset

).
 In practice, for this 
\begin_inset Formula $3\times3$
\end_inset

 problem, 
\begin_inset Formula $\delta=0$
\end_inset

 works well.
\end_layout

\begin_layout Section
Appendix - Body co-rotated, modal approach (BC-MODAL) 
\begin_inset CommandInset label
LatexCommand label
name "sec:BC-MODAL"

\end_inset


\begin_inset Note Note
status open

\begin_layout Plain Layout
Review from here
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Let a modal, reduced order base be spanned by the columns of matrix 
\begin_inset Formula $\mathbf{E}$
\end_inset

 so that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{E}^{T}\mathbf{M}\mathbf{E}=\mbox{diag}\left(1\right)\mbox{ and }\mathbf{E}^{T}\mathbf{K}\mathbf{E}=\mbox{diag}\left(\lambda_{i}\right)
\end{equation}

\end_inset

and hence 
\begin_inset Formula $\mathbf{E}$
\end_inset

,
\begin_inset Formula $\lambda_{i}$
\end_inset

 store selected eigenvectors and eigenvalues of the initial linearized dynamic
 system.
 Let the eigenvectors and eigenvalues be sorted, so that the initial six
 vectors represent purely rigid motion and are accompanied by zero eigenvalues.
 The scheme from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BC-RO"

\end_inset

 remains almost unchanged.
 The projection formula (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:q-proj"

\end_inset

) becomes
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{q}}^{t+h/2}=\mathbf{E}^{T}\mathbf{M}\mathbf{\Lambda}_{1}^{T}\mathbf{d}\label{eq:q-proj-modal}
\end{equation}

\end_inset

where the 
\begin_inset Formula $\mathbf{M}$
\end_inset

-scaling ensures 
\begin_inset Formula $\left\langle \bar{\mathbf{q}},\bar{\mathbf{q}}\right\rangle =\left\langle \mathbf{E}\bar{\mathbf{q}},\mathbf{M}\mathbf{E}\bar{\mathbf{q}}\right\rangle $
\end_inset

 
\begin_inset Note Note
status open

\begin_layout Plain Layout
perhaps look more into this aspect
\end_layout

\end_inset

, and the reduced internal force becomes 
\begin_inset Formula $\bar{\mathbf{f}}_{int}^{t+h/2}=\mbox{diag}\left(\lambda_{i}\right)\bar{\mathbf{q}}^{t+h/2}\mbox{.}$
\end_inset

 Further, the reduced system (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:redsys"

\end_inset

) is replaced by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mbox{diag}\left(1+\left(\frac{\eta h}{2}+\frac{h^{2}}{4}\right)\lambda_{i}\right)\left(\bar{\mathbf{u}}^{t+h}-\bar{\mathbf{u}}^{t}\right)=\mathbf{E}^{T}\underline{\mathbf{\Lambda}}_{1}^{T}\left(\mathbf{b}+\mathbf{H}^{T}\mathbf{R}\right)\label{eq:redsys-modal}
\end{equation}

\end_inset

and the system matrix (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Ared"

\end_inset

) becomes
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{A}}=\mbox{diag}\left(1+\left(\frac{\eta h}{2}+\frac{h^{2}}{4}\right)\lambda_{i}\right)\text{.}\label{eq:Ared-modal}
\end{equation}

\end_inset

Also, instead of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bred"

\end_inset

) we have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{b}}=h\left(\mathbf{E}^{T}\underline{\mathbf{\Lambda}_{1}}^{T}\mathbf{f}^{t+h/2}-\mbox{diag}\left(\lambda_{i}\right)\left(\bar{\mathbf{q}}^{t+h/2}+\eta\bar{\mathbf{v}}^{t}\right)\right)\label{eq:bred-modal}
\end{equation}

\end_inset

and projection (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:v0-proj"

\end_inset

) is replaced by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{v}}^{t}=\mathbf{E}^{T}\mathbf{M}\underline{\mathbf{\Lambda}_{1}}^{T}\mathbf{u}^{t}\mbox{.}\label{eq:v0-proj-modal}
\end{equation}

\end_inset

Projection (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:v1-proj"

\end_inset

) is replaced by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{\bar{v}}^{t+h}=\mathbf{E}^{T}\mathbf{M}\left(\underline{\mathbf{\Lambda}}^{t+h}\right)^{T}\mathbf{u}^{t+h}\label{eq:v1-proj-modal}
\end{equation}

\end_inset

and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\left\{ \bar{u}_{7},\bar{u}_{8},...,\bar{u}_{n}\right\} ^{t+h}=\left\{ \bar{v}_{7},\bar{v}_{8},...,\bar{v}_{n}\right\} ^{t+h}\label{eq:v1-proj-modal-subst}
\end{equation}

\end_inset

so that only deformable components of 
\begin_inset Formula $\bar{\mathbf{u}}^{t+h}$
\end_inset

 are substituted: this improves the long-term energy behavior.
 Finally, projection (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:q1red"

\end_inset

) is replaced by
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\bar{\mathbf{q}}^{t+h}=\mathbf{E}^{T}\mathbf{M}\left(\underline{\mathbf{\Lambda}}^{t+h}\right)^{T}\left[\left(\underline{\mathbf{I}-\mathbf{\Lambda}^{t+h}}\right)\mathbf{Z}+\mathbf{q}^{t+h}\right]\mbox{.}\label{eq:q1red-modal}
\end{equation}

\end_inset

The remaining formulas remain as in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BC-RO"

\end_inset

.
\end_layout

\begin_layout Section
Appendix - Implementation
\begin_inset CommandInset label
LatexCommand label
name "sec:Implementation"

\end_inset


\end_layout

\begin_layout Standard
Methods presented here are a part of Solfec; Solfec source code and documentatio
n are available at:
\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
target "https://github.com/tkoziara/solfec/"

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
target "http://parmes.org/solfec"

\end_inset

 
\end_layout

\begin_layout Standard
Implementation of presented here is included with:
\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
target "https://github.com/tkoziara/solfec/blob/master/fem.c"

\end_inset


\end_layout

\begin_layout Standard
The approach from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Total-Lagrangian"

\end_inset

 is implemented in functions starting with TL_, e.g.
\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
target "https://github.com/tkoziara/solfec/blob/master/fem.c#L1757"

\end_inset


\end_layout

\begin_layout Standard
\noindent
The approach from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Co-rotated-stepping"

\end_inset

 is implemented in functions starting with BC_, e.g.
\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
target "https://github.com/tkoziara/solfec/blob/master/fem.c#L2007"

\end_inset


\end_layout

\begin_layout Standard
The approach from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BC-RO"

\end_inset

 and Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:BC-MODAL"

\end_inset

 is implemented in functions starting with RO_, e.g.
\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
target "https://github.com/tkoziara/solfec/blob/master/fem.c#L2354"

\end_inset


\end_layout

\begin_layout Standard
The examples can respectively be found at:
\end_layout

\begin_layout Itemize
...
\end_layout

\begin_layout Itemize
...
\end_layout

\begin_layout Itemize
...
\end_layout

\begin_layout Itemize
...
\end_layout

\begin_layout Section*
Acknowledgements
\end_layout

\begin_layout Standard
The support from EDF Energy is gratefully acknowledged.
\end_layout

\begin_layout Section*
Revision notes
\end_layout

\begin_layout Description
Rev.
\begin_inset space ~
\end_inset

1 Initial revision;
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "../../bib/contact,../../bib/stepping,../../bib/tk,../../bib/fem,../../bib/flexible,../../bib/books,../../bib/constitutive"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
