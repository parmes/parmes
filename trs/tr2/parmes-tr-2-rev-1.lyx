#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass scrartcl
\use_default_options false
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder false
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\pdf_quoted_options "linkcolor=blue, urlcolor=blue, citecolor=blue"
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine natbib
\cite_engine_type authoryear
\biblio_style plainnat
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Titlehead
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
date{}
\end_layout

\end_inset

Oct, 2017
\end_layout

\begin_layout Subject
\begin_inset CommandInset href
LatexCommand href
name "PARMES"
target "http://parmes.github.io"

\end_inset

 - technical report - 2 - revision - 1
\end_layout

\begin_layout Title
A projected quasi-Newton method for dynamic multibody frictional contact
 problems
\end_layout

\begin_layout Standard
\align center

\size larger
Summary
\end_layout

\begin_layout Standard
We present a simple projected quasi-Newton approach for dealing with frictional
 contact constraints in multibody dynamic simulations.
 A regularized linear subproblem is solved inexactly at every Newton step,
 rendering the method attractive in the context of parallel computations.
 Our approach performs comparably with the commonly used Gauss-Seidel scheme,
 while having a much lower communication cost in parallel.
 We include examples of rigid and deformable problems, run on a distributed
 memory cluster.
 An implementation of the presented method is available at 
\begin_inset CommandInset href
LatexCommand href
target "https://parmes.github.io/solfec"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Standard
\align center

\size larger
Contributors
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="1">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Tomasz Koziara, t.koziara@gmail.com
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
The motivation behind the presented work is in modeling the dynamics of
 large collections of bodies interacting via contact and friction.
 Our point of departure is Contact Dynamics, an implicit method originated
 by Moreau 
\begin_inset CommandInset citation
LatexCommand citep
key "Moreau01"

\end_inset

 and Jean 
\begin_inset CommandInset citation
LatexCommand citep
key "Jean01"

\end_inset

, facilitating time integration with relatively large time steps.
 In order to solve for contact reactions Contact Dynamics employs nonlinear
 Gauss-Seidel relaxation.
 Although this approach is quite robust, its distributed memory implementation
 requires much care 
\begin_inset CommandInset citation
LatexCommand citep
key "Koziara2010"

\end_inset

, and can be inefficient when convergence is slow.
 In an earlier research 
\begin_inset CommandInset citation
LatexCommand citep
key "Koziara2008"

\end_inset

 we have looked into a nonsmooth Newton approach, easier to parallelize,
 but representing potentially troublesome due to oscillatory behavior.
 The current work proposes an alternative formulation.
 We use the work of De Saxc
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

e and Feng 
\begin_inset CommandInset citation
LatexCommand citep
key "DeSaxce1998"

\end_inset

 and modify the linearization by Fukushima et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Fukushima2002"

\end_inset

 in order to formulate the dynamic frictional contact problem as smooth
 root finding.
 In order to find approximate solutions, we subsequently develop a projected
 quasi-Newton method, which scales in parallel and converges sufficiently
 well to replace the Gauss-Seidel approach for the problem set of our interest.
 This approach may be useful in a broader sense and hence it is documented
 in the current report.
 We refer the reader to reviews 
\begin_inset CommandInset citation
LatexCommand citep
key "Stewart2000,Brogliato2002"

\end_inset

 for a perspective on finite-dimensional multibody contact/impact dynamics.
 
\begin_inset CommandInset href
LatexCommand href
name "The list of cross-references"
target "http://epubs.siam.org/doi/10.1137/S0036144599360110"

\end_inset

 of review 
\begin_inset CommandInset citation
LatexCommand citep
key "Stewart2000"

\end_inset

 may be helpful in tracking recent developments in the field.
 For example a solution method by Mazhar et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Mazhar2015"

\end_inset

 has a similar character to the one presented here.
\end_layout

\begin_layout Standard
A brief account of discrete multibody dynamics is given in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Discrete-dynamics"

\end_inset

.
 Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Frictional-contact"

\end_inset

 formulates the frictional contact problem.
 Smoothing is discussed in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Smoothing"

\end_inset

.
 In Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Constraints-satisfaction"

\end_inset

 a convenient measure of accuracy is defined.
 Linearization is outlined in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Linearization"

\end_inset

.
 The projected quasi-Newton method is detailed in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:PQN"

\end_inset

, followed by examples in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Examples"

\end_inset

.
 The paper is concluded in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Conclusions"

\end_inset

.
 In addition, Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Derivative"

\end_inset

 includes derivation of a smoothed derivative, while Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Links"

\end_inset

 provides links to source code and examples files.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Discrete-dynamics"

\end_inset

Discrete multibody dynamics
\end_layout

\begin_layout Standard
At time 
\begin_inset Formula $t$
\end_inset

 a set of bodies has configuration 
\begin_inset Formula $\mathbf{q}^{t}$
\end_inset

 and velocity 
\begin_inset Formula $\mathbf{u}^{t}$
\end_inset

.
 Consecutive values 
\begin_inset Formula $\mathbf{q}^{t+h}$
\end_inset

, 
\begin_inset Formula $\mathbf{u}^{t+h}$
\end_inset

 for 
\begin_inset Formula $h>0$
\end_inset

 are obtained by numerical integration of the momentum balance and the kinematic
 relation 
\begin_inset Formula $\dot{\mathbf{q}}=\mathbf{u}$
\end_inset

.
 In order to focus attention, we briefly outline a scheme originally presented
 in 
\begin_inset CommandInset citation
LatexCommand citep
key "Moreau01"

\end_inset

.
 A half-step configuration is obtained as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h/2}=\mathbf{q}^{t}+\frac{h}{2}\mathbf{u}^{t}\mbox{.}\label{eq:q-half}
\end{equation}

\end_inset

The velocity update reads
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{u}^{t+h}=\mathbf{b}^{t+h}+\mathbf{A}^{-1}\mathbf{H}^{T}\mathbf{R}\label{eq:u}
\end{equation}

\end_inset

where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{b}^{t+h}=\mathbf{u}^{t}+h\mathbf{A}^{-1}\mathbf{f}\label{eq:b}
\end{equation}

\end_inset

is a free velocity, not accounting for an influence of constraints.
 When 
\begin_inset Formula $\mathbf{A}=\mathbf{M}$
\end_inset

, where 
\begin_inset Formula $\mathbf{M}$
\end_inset

 is an inertia matrix, (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:b"

\end_inset

) corresponds to an explicit scheme detailed in 
\begin_inset CommandInset citation
LatexCommand citep
key "Moreau01,Koziara2008PhD"

\end_inset

.
 For 
\begin_inset Formula $\mathbf{A}=\mathbf{M}+\left(h^{2}/4\right)\mathbf{K}$
\end_inset

, where 
\begin_inset Formula $\mathbf{K}=-\{\partial\mathbf{f}/\partial\mathbf{q}\}\left(\mathbf{q}^{t+h/2}\right)$
\end_inset

 is a stiffness matrix, (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:b"

\end_inset

) corresponds to the linearly-implicit scheme by Zhang and Skeel 
\begin_inset CommandInset citation
LatexCommand citep
key "Zhang1997"

\end_inset

.
 In both cases the out of balance force 
\begin_inset Formula $\mathbf{f}=\mathbf{f}\left(\mathbf{q}^{t+h/2},t+\frac{h}{2}\right)$
\end_inset

.
 For smooth problems both integrators have good conservation properties
 and are of second order.
 Naturally, the linearly-implicit scheme allows for larger time steps.
 While (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:b"

\end_inset

) represents a regular velocity update for an unconstrained system, (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:u"

\end_inset

) accounts for the constraints by adding a contribution of their reactions
 
\begin_inset Formula $\mathbf{R}$
\end_inset

.
 In (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:u"

\end_inset

) 
\begin_inset Formula $\mathbf{A}=\mathbf{A}\left(\mathbf{q}^{t+h/2}\right)$
\end_inset

 and 
\begin_inset Formula $\mathbf{H}=\mathbf{H}\left(\mathbf{q}^{t+h/2}\right)$
\end_inset

, while 
\begin_inset Formula $\mathbf{R}=\int_{t}^{t+h}d\mathbf{R}$
\end_inset

 is considered to be an impulse.
 
\begin_inset Formula $\mathbf{H}$
\end_inset

 is a linear operator mapping the body space velocity 
\begin_inset Formula $\mathbf{u}$
\end_inset

 into a constraint space velocity 
\begin_inset Formula $\mathbf{U}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}=\mathbf{H}\mathbf{u}\mbox{.}\label{eq:H}
\end{equation}

\end_inset

For example, in case of finite elements, 
\begin_inset Formula $\mathbf{H}$
\end_inset

 is a global to local coordinates transformation of the shape functions
 values nonzero at constraint points.
 Once 
\begin_inset Formula $\mathbf{R}$
\end_inset

 is known, after obtaining 
\begin_inset Formula $\mathbf{u}^{t+h}$
\end_inset

 the final configuration update reads 
\begin_inset Formula 
\begin{equation}
\mathbf{q}^{t+h}=\mathbf{q}^{t+h/2}+\frac{h}{2}\mathbf{u}^{t+h}\mbox{.}\label{eq:q-end}
\end{equation}

\end_inset

In the remaining part of the paper we discuss how to calculate 
\begin_inset Formula $\mathbf{R}$
\end_inset

 in case of frictional contact constraints.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Frictional-contact"

\end_inset

Frictional contact formulation
\end_layout

\begin_layout Standard
At 
\begin_inset Formula $\mathbf{q}^{t+h/2}$
\end_inset

 we identify a number of points where pairs of bodies interact by contact.
 At those points, indexed by 
\begin_inset Formula $\alpha$
\end_inset

, we introduce local coordinate systems.
 Each of those systems has an axis pointing into the normal direction.
 This is the direction along which bodies separate.
 The remaining two axes span a tangent plane.
 This is the plane in which bodies shear.
 At each contact point, using the local coordinate system, we consider a
 relative velocity 
\begin_inset Formula $\mathbf{U}_{\alpha}$
\end_inset

 and an impulse force 
\begin_inset Formula $\mathbf{R}_{\alpha}$
\end_inset

.
 Their relationship is linear
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}_{\alpha}=\sum_{\beta}\mathbf{W}_{\alpha\beta}\mathbf{R}_{\beta}+\mathbf{B}_{\alpha}\label{eq:UWRB}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{W}_{\alpha\beta}$
\end_inset

 are 
\begin_inset Formula $3\times3$
\end_inset

 block matrices and 
\begin_inset Formula $\mathbf{B}_{\alpha}$
\end_inset

 are 
\begin_inset Formula $3$
\end_inset

-vectors contributing to
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{W}=\mathbf{H}\mathbf{A}^{-1}\mathbf{H}^{T}\label{eq:W}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{B}=\mathbf{H}\mathbf{b}^{t+h}
\end{equation}

\end_inset

in a suitable manner.
 Because for 
\begin_inset Formula $\mathbf{R}=\mathbf{0}$
\end_inset

 there holds 
\begin_inset Formula $\mathbf{U}=\mathbf{B}$
\end_inset

, 
\begin_inset Formula $\mathbf{B}$
\end_inset

 is the free relative velocity at the constraints.
\end_layout

\begin_layout Standard
At contact points we consider a minimalistic interface law, reflecting the
 core difficulties related to the lack of smoothness and the non-associated
 character of friction.
 In terms of normal behaviour we employ the velocity Signorini condition,
 
\begin_inset Formula $U_{\alpha N}\ge0,\,\,\,R_{\alpha N}\ge0,\,\,\,U_{\alpha N}R_{\alpha N}=0$
\end_inset

.
 In terms of shearing behavior we utilize the Coulomb law, 
\begin_inset Formula $\mathbf{R}_{\alpha}\in\mbox{interior}\left(K_{\alpha}\right)\Rightarrow\mathbf{U}_{\alpha T}=0$
\end_inset

 and 
\begin_inset Formula $\mathbf{R}_{\alpha}\in\mbox{boundary}\left(K_{\alpha}\right)\Rightarrow\mathbf{U}_{\alpha T}=-\gamma\mathbf{R}_{\alpha T}$
\end_inset

, where 
\begin_inset Formula $\gamma>0$
\end_inset

.
 The friction cone 
\begin_inset Formula $K_{\alpha}$
\end_inset

 is defined as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
K_{\alpha}=\left\{ \mathbf{R}_{\alpha}:\left\Vert \mathbf{R}_{\alpha T}\right\Vert \le\mu_{\alpha}R_{\alpha N},R_{\alpha N}\ge0\right\} 
\end{equation}

\end_inset

where 
\begin_inset Formula $\mu_{\alpha}$
\end_inset

 is the coefficient of friction.
 It has been shown by De Saxc
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
'
\end_layout

\end_inset

e and Feng 
\begin_inset CommandInset citation
LatexCommand citep
key "DeSaxce1998"

\end_inset

, that the Signorini-Coulomb law can be expressed in a compact form
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula 
\begin{equation}
-\left[\begin{array}{c}
\mathbf{U}_{\alpha T}\\
U_{\alpha N}+\mu_{\alpha}\left\Vert \mathbf{U}_{\alpha T}\right\Vert 
\end{array}\right]\in N_{K_{\alpha}}\left(\mathbf{R}_{\alpha}\right)\label{eq:DSF}
\end{equation}

\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
where 
\begin_inset Formula $N_{K_{\alpha}}$
\end_inset

 stands for the normal cone of the set 
\begin_inset Formula $K_{\alpha}$
\end_inset

.
 For a convex set 
\begin_inset Formula $A$
\end_inset

 the normal cone 
\begin_inset Formula $N_{A}\left(\mathbf{R}\right)$
\end_inset

 at point 
\begin_inset Formula $\mathbf{R}\in A$
\end_inset

 is defined as the set of all vectors 
\begin_inset Formula $\mathbf{V}$
\end_inset

 such that 
\begin_inset Formula $\left\langle \mathbf{V},\mathbf{S}-\mathbf{R}\right\rangle \le0$
\end_inset

 for all 
\begin_inset Formula $\mathbf{S}\in A$
\end_inset

.
 Let us now define
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{F}\left(\mathbf{R}\right)=\left[\begin{array}{c}
...\\
\mathbf{U}_{\alpha T}\left(\mathbf{R}\right)\\
U_{\alpha N}\left(\mathbf{R}\right)+\mu_{\alpha}\left\Vert \mathbf{U}_{\alpha T}\left(\mathbf{R}\right)\right\Vert \\
...
\end{array}\right]\label{eq:F}
\end{equation}

\end_inset

and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
K=\prod_{\alpha}K_{\alpha}
\end{equation}

\end_inset

where the dependence 
\begin_inset Formula $\mathbf{U}_{\alpha}\left(\mathbf{R}\right)$
\end_inset

 is defined in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:UWRB"

\end_inset

), and 
\begin_inset Formula $\mathbf{R}$
\end_inset

 is a collection of 
\begin_inset Formula $\mathbf{R}_{\alpha}$
\end_inset

 for 
\begin_inset Formula $\alpha\in\left\{ 1,...,\nu\right\} $
\end_inset

.
 Formula (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:DSF"

\end_inset

) states, that the frictional contact constraints are satisfied if 
\begin_inset Formula $-\mathbf{F}\left(\mathbf{R}\right)$
\end_inset

 belongs to the normal cone of 
\begin_inset Formula $K$
\end_inset

 at 
\begin_inset Formula $\mathbf{R}$
\end_inset

.
 Hence
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
-\mathbf{F}\left(\mathbf{R}\right)=\mathbf{R}-\mathbf{F}\left(\mathbf{R}\right)-\mbox{proj}_{K}\left(\mathbf{R}-\mathbf{F}\left(\mathbf{R}\right)\right)
\end{equation}

\end_inset

which can be reduced to the standard projection formula 
\begin_inset Formula $\mathbf{R}=\mbox{proj}_{K}\left(\mathbf{R}-\mathbf{F}\left(\mathbf{R}\right)\right)$
\end_inset

.
 Let us not do it though, but rather define a vector field
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{m}\left(\mathbf{S}\right)=\mathbf{S}-\mbox{proj}_{K}\left(\mathbf{S}\right)\mbox{.}
\end{equation}

\end_inset

We can rewrite (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:DSF"

\end_inset

) as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{C}\left(\mathbf{R}\right)=\mathbf{F}\left(\mathbf{R}\right)+\mathbf{m}\left(\mathbf{R}-\mathbf{F}\left(\mathbf{R}\right)\right)=\mathbf{0}\mbox{ and }\mathbf{R}\in K\mbox{,}\label{eq:C1}
\end{equation}

\end_inset

a root finding problem defined within the friction cone.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Smoothing"

\end_inset

Smoothing
\end_layout

\begin_layout Standard
Projection is a nonsmooth operator and so is 
\begin_inset Formula $\mathbf{m}\left(\mathbf{S}\right)$
\end_inset

.
 Similarly, 
\begin_inset Formula $\mathbf{F}\left(\mathbf{R}\right)$
\end_inset

 is not smooth due to 
\begin_inset Formula $\left\Vert \mathbf{U}_{\alpha T}\left(\mathbf{R}\right)\right\Vert $
\end_inset

.
 Since our aim to to develop a Newton-like approach for equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:C1"

\end_inset

), some suitable notion of derivative needs to be put in place.
 Plethora of nonsmooth analytical tools have been developed in recent decades,
 many of which are summarized in the monograph 
\begin_inset CommandInset citation
LatexCommand citep
key "RW98"

\end_inset

.
 This avenue has been investigated in our previous work 
\begin_inset CommandInset citation
LatexCommand citep
key "Koziara2008"

\end_inset

.
 In this paper we are interested in exploring the classical smooth toolbox
 and hence we adopt the work of Fukushima at al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Fukushima2002"

\end_inset

 in the context of frictional contact.
 Since we shall need a gradient of 
\begin_inset Formula $\mathbf{C}\left(\mathbf{R}\right)$
\end_inset

, our first step is to produce its smooth approximation 
\begin_inset Formula $\mathbf{C}_{\omega}\left(\mathbf{R}\right)$
\end_inset

, such that 
\begin_inset Formula $\nabla\mathbf{C}_{\omega}\left(\mathbf{R}\right)$
\end_inset

 is well defined for all 
\begin_inset Formula $\omega>0$
\end_inset

.
\end_layout

\begin_layout Subsection
Smoothed 
\begin_inset Formula $\mathbf{m}\left(\mathbf{S}\right)$
\end_inset


\end_layout

\begin_layout Standard
A polar cone 
\begin_inset Formula $K_{\alpha}^{\circ}$
\end_inset

 of the friction cone 
\begin_inset Formula $K_{\alpha}$
\end_inset

 is defined as follows
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
K_{\alpha}^{\circ}=\left\{ \mathbf{V}:\left\langle \mathbf{V},\mathbf{S}\right\rangle \le0\mbox{ for all }\mathbf{S}\in K_{\alpha}\right\} =N_{K_{\alpha}}\left(\mathbf{0}\right)\mbox{.}
\end{equation}

\end_inset

For any 
\begin_inset Formula $\mathbf{S}_{\alpha}$
\end_inset

 we have (Moreau)
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{S}_{\alpha}=\mbox{proj}_{K_{\alpha}}\left(\mathbf{S}_{\alpha}\right)+\mbox{proj}_{K_{\alpha}^{\circ}}\left(\mathbf{S}_{\alpha}\right)
\end{equation}

\end_inset

and hence
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{m}_{\alpha}\left(\mathbf{S}_{\alpha}\right)=\mbox{proj}_{K_{\alpha}^{\circ}}\left(\mathbf{S}_{\alpha}\right)\mbox{.}
\end{equation}

\end_inset

We use the analysis from 
\begin_inset CommandInset citation
LatexCommand citep
key "Fukushima2002"

\end_inset

 in order to derive a smoothed 
\begin_inset Formula $\mathbf{m}\left(\mathbf{S}\right)$
\end_inset

.
 In 
\begin_inset CommandInset citation
LatexCommand citep
key "Fukushima2002"

\end_inset

 only the self-dual case 
\begin_inset Formula $\mu_{\alpha}=1$
\end_inset

 was considered.
 The formulas obtained here represent a slight generalization.
 In order to avoid clutter, we temporarily omit the 
\begin_inset Formula $\alpha$
\end_inset

-indexing of contact point entities.
 For any 
\begin_inset Formula $\mathbf{z}\in R^{3}$
\end_inset

 we define the following spectral factorization with respect to the pair
 of cones 
\begin_inset Formula $-K$
\end_inset

 and 
\begin_inset Formula $K^{\circ}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{z}=\lambda_{1}\mathbf{u}_{1}+\lambda_{2}\mathbf{u}_{2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda_{1}$
\end_inset

, 
\begin_inset Formula $\lambda_{2}$
\end_inset

 are spectral values
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\lambda_{1}=\frac{-z_{N}-\mu\left\Vert \mathbf{z}_{T}\right\Vert }{1+\mu^{2}},\,\,\,\lambda_{2}=\frac{\left\Vert \mathbf{z}_{T}\right\Vert -\mu z_{N}}{1+\mu^{2}}\label{eq:l12}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{u}_{1}$
\end_inset

, 
\begin_inset Formula $\mathbf{u}_{2}$
\end_inset

 are spectral vectors
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{u}_{1}=\left\{ \begin{array}{ccc}
\left[\begin{array}{c}
-\mu\frac{\mathbf{z}_{T}}{\left\Vert \mathbf{z}_{T}\right\Vert }\\
-1
\end{array}\right] & \mbox{if} & \mathbf{z}_{T}\ne\mathbf{0}\\
\left[\begin{array}{c}
-\mu\mathbf{w}\\
-1
\end{array}\right] & \mbox{if} & \mathbf{z}_{T}=\mathbf{0}
\end{array}\right.\label{eq:u1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{u}_{2}=\left\{ \begin{array}{ccc}
\left[\begin{array}{c}
\frac{\mathbf{z}_{T}}{\left\Vert \mathbf{z}_{T}\right\Vert }\\
-\mu
\end{array}\right] & \mbox{if} & \mathbf{z}_{T}\ne\mathbf{0}\\
\left[\begin{array}{c}
\mathbf{w}\\
-\mu
\end{array}\right] & \mbox{if} & \mathbf{z}_{T}=\mathbf{0}
\end{array}\right.\label{eq:u2}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{w}\in R^{2}$
\end_inset

 and 
\begin_inset Formula $\left\Vert \mathbf{w}\right\Vert =1$
\end_inset

.
 For any 
\begin_inset Formula $\mathbf{z}\in R^{3}$
\end_inset

 we can write
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mbox{proj}_{K^{\circ}}\left(\mathbf{z}\right)=\max\left(0,\lambda_{1}\right)\mathbf{u}_{1}+\max\left(0,\lambda_{2}\right)\mathbf{u}_{2}\label{eq:proj_K_po}
\end{equation}

\end_inset

where 
\begin_inset Formula $\lambda_{1},\lambda_{2}$
\end_inset

 and 
\begin_inset Formula $\mathbf{u}_{1},\mathbf{u}_{2}$
\end_inset

 are defined in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:l12"

\end_inset

), (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:u1"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:u2"

\end_inset

).
 For any 
\begin_inset Formula $\mathbf{z}\in R^{3}$
\end_inset

 with 
\begin_inset Formula $\mathbf{z}_{T}\ne\mathbf{0}$
\end_inset

 we take a slice of 
\begin_inset Formula $R^{3}$
\end_inset

 and span a Cartesian 
\begin_inset Formula $x$
\end_inset

-
\begin_inset Formula $y$
\end_inset

 frame along 
\begin_inset Formula $\mathbf{z}_{T}$
\end_inset

 and 
\begin_inset Formula $\left[0,0,1\right]^{T}$
\end_inset

 respectively.
 Then 
\begin_inset Formula $x_{\mathbf{z}}>0$
\end_inset

, 
\begin_inset Formula $\mathbf{u}_{1}$
\end_inset

 corresponds to a 
\begin_inset Formula $x$
\end_inset

-negative face of 
\begin_inset Formula $K^{\circ}$
\end_inset

 and 
\begin_inset Formula $\mathbf{u}_{2}$
\end_inset

 corresponds to a 
\begin_inset Formula $x$
\end_inset

-positive face of 
\begin_inset Formula $-K$
\end_inset

.
 Clearly, 
\begin_inset Formula $\mathbf{u}_{1}\perp\mathbf{u}_{2}$
\end_inset

 and 
\begin_inset Formula $\lambda_{1}$
\end_inset

 and 
\begin_inset Formula $\lambda_{2}$
\end_inset

 are the normalized projections of 
\begin_inset Formula $\mathbf{z}$
\end_inset

 onto these two directions.
 Formula (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:proj_K_po"

\end_inset

) follows from the geometry of 
\begin_inset Formula $-K$
\end_inset

 and 
\begin_inset Formula $K^{\circ}$
\end_inset

.
\end_layout

\begin_layout Standard
The projection operator as defined in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:proj_K_po"

\end_inset

) is nonsmooth.
 Motivated by 
\begin_inset CommandInset citation
LatexCommand citep
key "Fukushima2002,Hayashi2005"

\end_inset

 we employ the following smoothing
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mbox{proj}_{K^{\circ}}^{\omega}\left(\mathbf{z}\right)=\omega g\left(\lambda_{1}/\omega\right)\mathbf{u}_{1}+\mu\omega g\left(\lambda_{2}/\left(\mu\omega\right)\right)\mathbf{u}_{2}\label{eq:proj_K_ps}
\end{equation}

\end_inset

where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
g\left(\lambda\right)=\frac{1}{2}\left(\sqrt{\lambda^{2}+4}+\lambda\right)\mbox{.}\label{eq:g}
\end{equation}

\end_inset

The smoothing function 
\begin_inset Formula $\omega g\left(\lambda/\omega\right)$
\end_inset

 is differentiable for all 
\begin_inset Formula $\omega>0$
\end_inset

 and it converges to 
\begin_inset Formula $\max\left(0,\lambda\right)$
\end_inset

 when 
\begin_inset Formula $\omega\downarrow0$
\end_inset

.
 There also hold
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\lim_{\lambda\rightarrow-\infty}g\left(\lambda\right)=0,\,\,\,\lim_{\lambda\rightarrow\infty}(g\left(\lambda\right)-\lambda)=0,\,\,\,0<\dot{g}\left(\lambda\right)<1
\end{equation}

\end_inset

mimicking the behavior of 
\begin_inset Formula $\max\left(0,\lambda\right)$
\end_inset

.
 The gradient of the smoothed projection onto the polar cone reads
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\mbox{proj}_{K^{\circ}}^{\omega}\left(\mathbf{z}\right)=\left\{ \begin{array}{ccc}
\dot{g}\left(\lambda_{1}/\omega\right)\mathbf{I} & \mbox{if} & \mathbf{z}_{T}=\mathbf{0}\\
\left[\begin{array}{cc}
a\mathbf{I}+\left(b-a\right)\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2} & c\mathbf{z}_{T}/\left\Vert \mathbf{z}_{T}\right\Vert \\
c\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert  & d
\end{array}\right] & \mbox{if} & \mathbf{z}_{T}\ne\mathbf{0}
\end{array}\right.\label{eq:grad_proj}
\end{equation}

\end_inset

where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
a=\frac{g\left(\lambda_{2}/\left(\mu\omega\right)\right)-g\left(\lambda_{1}/\omega\right)}{\lambda_{2}/\left(\mu\omega\right)-\lambda_{1}/\omega},b=\frac{\mu^{2}\dot{g}\left(\lambda_{1}/\omega\right)+\dot{g}\left(\lambda_{2}/\left(\mu\omega\right)\right)}{1+\mu^{2}}\label{eq:ab1}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
c=\frac{\mu\left(\dot{g}\left(\lambda_{1}/\omega\right)-\dot{g}\left(\lambda_{2}/\left(\mu\omega\right)\right)\right)}{1+\mu^{2}},d=\frac{\dot{g}\left(\lambda_{1}/\omega\right)+\mu^{2}\dot{g}\left(\lambda_{2}/\left(\mu\omega\right)\right)}{1+\mu^{2}}\mbox{.}\label{eq:cd1}
\end{equation}

\end_inset

A detailed derivation of the above formula can be found in Appendix 2, where
 after 
\begin_inset CommandInset citation
LatexCommand citep
key "Fukushima2002,Hayashi2005"

\end_inset

 we also show that 
\begin_inset Formula $\nabla\mbox{proj}_{K^{\circ}}^{\omega}$
\end_inset

 is positive definite for 
\begin_inset Formula $\omega>0$
\end_inset

.
 Finally, the smoothed 
\begin_inset Formula $\mathbf{m}\left(\mathbf{S}\right)$
\end_inset

 reads
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{m}_{\omega}\left(\mathbf{S}\right)=\mbox{proj}{}_{K^{\circ}}^{\omega}\left(\mathbf{S}\right)\mbox{.}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Zero friction
\end_layout

\begin_layout Standard
It is instructive to investigate the behavior of 
\begin_inset Formula $\mathbf{m}_{\omega}\left(\mathbf{S}\right)$
\end_inset

 and its gradient in the limit case of 
\begin_inset Formula $\mu=0$
\end_inset

.
 For 
\begin_inset Formula $g_{1}=\omega g\left(\lambda_{1}/\omega\right)$
\end_inset

 and 
\begin_inset Formula $g_{2}=\mu\omega g\left(\lambda_{2}/\left(\mu\omega\right)\right)$
\end_inset

 we have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
g_{1}=\frac{1}{2}\left(\lambda_{1}+\sqrt{\lambda_{1}^{2}+4\omega^{2}}\right),g_{2}=\frac{1}{2}\left(\lambda_{2}+\sqrt{\lambda_{2}^{2}+4\mu^{2}\omega^{2}}\right)
\end{equation}

\end_inset

and hence
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{m}_{\omega}\left(\mathbf{S}\right)=g_{1}\mathbf{u}_{1}+\max\left(0,\lambda_{2}\right)\mathbf{u}_{2}\mbox{.}
\end{equation}

\end_inset

The tangential direction 
\begin_inset Formula $\mathbf{u}_{2}$
\end_inset

 is not active in the frictionless case and it is not smoothed.
 For 
\begin_inset Formula $\mu=0$
\end_inset

 the tangential component of 
\begin_inset Formula $\mathbf{C}\left(\mathbf{R}\right)$
\end_inset

 reads
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{C}_{T}\left(\mathbf{R}\right)=\mathbf{F}_{T}\left(\mathbf{R}\right)+\mathbf{m}_{T}\left(\mathbf{R}-\mathbf{F}\left(\mathbf{R}\right)\right)=\mathbf{R}_{T}
\end{equation}

\end_inset

and hence 
\begin_inset Formula $\mathbf{C}_{T}\left(\mathbf{R}\right)=\mathbf{0}$
\end_inset

 implies 
\begin_inset Formula $\mathbf{R}_{T}=\mathbf{0}$
\end_inset

.
 This is also reflected in 
\begin_inset Formula $\nabla_{\omega}\mathbf{m}\left(\mathbf{S}\right)$
\end_inset

 and consequently in 
\begin_inset Formula $d\mathbf{C}_{\omega}\left(\mathbf{U},\mathbf{R}\right)=\nabla_{\omega}\mathbf{m}\left(\mathbf{R}-\mathbf{U}\right)d\mathbf{R}$
\end_inset

, since 
\begin_inset Formula $\nabla\mathbf{F}\left(\mathbf{U}\right)=\mathbf{I}$
\end_inset

 for 
\begin_inset Formula $\mu=0$
\end_inset

.
 Let us produce practical versions of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ab1"

\end_inset

) and (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:cd1"

\end_inset

) first.
 We have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\dot{g}_{1}=\frac{1}{2}\left(1+\lambda_{1}/\sqrt{\lambda_{1}^{2}+4\omega^{2}}\right),\dot{g}_{2}=\frac{1}{2}\left(1+\lambda_{2}/\sqrt{\lambda_{2}^{2}+4\mu^{2}\omega^{2}}\right)
\end{equation}

\end_inset

and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
a=\frac{1}{2}\left(1+\left(\lambda_{2}+\mu\lambda_{1}\right)/\left(\sqrt{\lambda_{2}^{2}+4\mu^{2}\omega^{2}}+\mu\sqrt{\lambda_{1}^{2}+4\omega^{2}}\right)\right)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
b=\left(\mu^{2}\dot{g}_{1}+\dot{g}_{2}\right)/\left(1+\mu^{2}\right)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
c=\mu\left(\dot{g}_{1}-\dot{g}_{2}\right)/\left(1+\mu^{2}\right)
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
d=\left(\dot{g}_{1}+\mu^{2}\dot{g}_{2}\right)/\left(1+\mu^{2}\right)\mbox{.}
\end{equation}

\end_inset

In case of 
\begin_inset Formula $\mathbf{z}_{T}=\mathbf{R}_{T}-\mathbf{F}\left(\mathbf{R}\right)_{T}=\mathbf{0}$
\end_inset

 the gradient is well defined in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:grad_proj"

\end_inset

).
 Otherwise it is quite easy to see that 
\begin_inset Formula $a=b=1$
\end_inset

, 
\begin_inset Formula $c=0$
\end_inset

, 
\begin_inset Formula $d=\dot{g}\left(\lambda_{1}/\omega\right)$
\end_inset

 and again 
\begin_inset Formula $\nabla\mathbf{m}_{\omega}\left(\mathbf{S}\right)$
\end_inset

 is well defined.
\end_layout

\begin_layout Subsection
Smoothed 
\begin_inset Formula $\mathbf{F}\left(\mathbf{R}\right)$
\end_inset


\end_layout

\begin_layout Standard
The smoothed 
\begin_inset Formula $\mathbf{F}\left(\mathbf{R}\right)$
\end_inset

 reads
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{F}_{\omega}\left(\mathbf{U}\right)=\left[\begin{array}{c}
...\\
\mathbf{U}_{\alpha T}\\
U_{\alpha N}+\mu_{\alpha}\left(\sqrt{\left\langle \mathbf{U}_{\alpha T},\mathbf{U}_{\alpha T}\right\rangle +\omega^{2}}-\omega\right)\\
...
\end{array}\right]
\end{equation}

\end_inset

so that 
\begin_inset Formula $\nabla\mathbf{F}_{\omega}$
\end_inset

 is well defined for any 
\begin_inset Formula $\omega>0$
\end_inset

 and the smoothed norm 
\begin_inset Formula $\left\Vert \mathbf{U}_{T}\right\Vert _{\omega}=\sqrt{\left\langle \mathbf{U}_{T},\mathbf{U}_{T}\right\rangle +\omega^{2}}-\omega=0$
\end_inset

 for 
\begin_inset Formula $\mathbf{U}_{T}=\mathbf{0}$
\end_inset

.
 
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Constraints-satisfaction"

\end_inset

Constraints satisfaction measure
\end_layout

\begin_layout Standard
For 
\begin_inset Formula $\mathbf{R}\in K$
\end_inset

 the vector function 
\begin_inset Formula $\mathbf{C}\left(\mathbf{R}\right)=\mathbf{F}\left(\mathbf{R}\right)+\mathbf{m}\left(\mathbf{R}-\mathbf{F}\left(\mathbf{R}\right)\right)$
\end_inset

 represents the relative velocity at contact points, which is not compatible
 with the Signorini-Coulomb frictional contact law.
 It is therefore possible to define a measure of constraints satisfaction,
 that has some physical interpretation.
 Because
\series bold
 
\series default

\begin_inset Formula $\mathbf{C}$
\end_inset

 is expressed in terms of velocity, the following quantity
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
g\left(\mathbf{R}\right)=\sum_{\alpha=1}^{\nu}\left\langle \mathbf{W}_{\alpha\alpha}^{-1}\mathbf{C}_{\alpha}\left(\mathbf{R}\right),\mathbf{C}_{\alpha}\left(\mathbf{R}\right)\right\rangle /\sum_{\alpha=1}^{\nu}\left\langle \mathbf{W}_{\alpha\alpha}^{-1}\mathbf{B}_{\alpha},\mathbf{B}_{\alpha}\right\rangle \label{eq:accuracy}
\end{equation}

\end_inset

approximately measures the amount of spurious energy, due to an inexact
 satisfaction of constraints.
 The denominator corresponds to the kinetic energy of the relative free
 motion.
 
\begin_inset Formula $\mathbf{W}_{\alpha\alpha}$
\end_inset

 are the diagonal, 
\begin_inset Formula $3\times3$
\end_inset

, positive definite blocks of 
\begin_inset Formula $\mathbf{W}$
\end_inset

.
 The above formula has already been used in 
\begin_inset CommandInset citation
LatexCommand citep
key "Koziara2010"

\end_inset

.
 It can be used to compare the accuracy of solutions obtained by means of
 different numerical approaches.
 The merit function 
\begin_inset Formula $g\left(\mathbf{R}\right)$
\end_inset

 is used in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:PQN"

\end_inset

 as a termination criterion for the projected quasi-Newton scheme.
 This is one among many possible choices (not necessarily the best).
 Selecting a good convergence criterion for ill-conditioned problems that
 are often generated by multibody frictional contact formulations remains
 an open issue.
 Other termination criteria has been discussed for example in 
\begin_inset CommandInset citation
LatexCommand citep
key "Renouf2005,Radjai2009"

\end_inset

.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Linearization"

\end_inset

Linearization
\end_layout

\begin_layout Standard
When linearizing the problem it is useful to think of 
\begin_inset Formula $\mathbf{U}$
\end_inset

 and 
\begin_inset Formula $\mathbf{R}$
\end_inset

 as independent and write
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{C}_{\omega}\left(\mathbf{U},\mathbf{R}\right)=\mathbf{F}_{\omega}\left(\mathbf{U}\right)+\mathbf{m}_{\omega}\left(\mathbf{R}-\mathbf{F}_{\omega}\left(\mathbf{U}\right)\right),\mathbf{U}=\mathbf{W}\mathbf{R}+\mathbf{B}\mbox{,}
\end{equation}

\end_inset

We then have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
d\mathbf{C}_{\omega}=\mathbf{X}d\mathbf{U}+\mathbf{Y}d\mathbf{R}
\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{X}$
\end_inset

 and 
\begin_inset Formula $\mathbf{Y}$
\end_inset

 are 
\begin_inset Formula $3\times3$
\end_inset

-block diagonal matrices
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{X}=\left[\mathbf{I}-\partial\mathbf{m}_{\omega}/\partial\mathbf{S}\right]\partial\mathbf{F}_{\omega}/\partial\mathbf{U}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{Y}=\partial\mathbf{m}_{\omega}/\partial\mathbf{S}
\end{equation}

\end_inset

and 
\begin_inset Formula $\mathbf{I}$
\end_inset

 is identity.
 The linearization reads
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{U}=\mathbf{W}\mathbf{R}+\mathbf{B}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{C}_{\omega}\left(\mathbf{U},\mathbf{R}\right)+\mathbf{X}d\mathbf{U}+\mathbf{Y}d\mathbf{R}=0
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
d\mathbf{U}=\mathbf{W}d\mathbf{R}\mbox{.}
\end{equation}

\end_inset

By eliminating 
\begin_inset Formula $\mathbf{U}$
\end_inset

 and 
\begin_inset Formula $d\mathbf{U}$
\end_inset

 we come back to 
\begin_inset Formula $\mathbf{C}_{\omega}\left(\mathbf{R}\right)=\mathbf{C}_{\omega}\left(\mathbf{W}\mathbf{R}+\mathbf{B},\mathbf{R}\right)$
\end_inset

 and see that in the linearization of 
\begin_inset Formula $\mathbf{C}_{\omega}\left(\mathbf{R}\right)=\mathbf{0}$
\end_inset

,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{C}_{\omega}\left(\mathbf{R}\right)+\nabla\mathbf{C}_{\omega}\left(\mathbf{R}\right)d\mathbf{R}=0\mbox{,}
\end{equation}

\end_inset

the gradient reads
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla\mathbf{C}_{\omega}\left(\mathbf{R}\right)=\mathbf{X}\mathbf{W}+\mathbf{Y}\mbox{.}\label{eq:Grad_C}
\end{equation}

\end_inset

It is noteworthy, that when using an iterative solver 
\begin_inset Formula $\nabla\mathbf{C}_{\omega}$
\end_inset

 does not need to be fully assembled.
 On the other hand it is clear that 
\begin_inset Formula $\nabla\mathbf{C}_{\omega}$
\end_inset

 and 
\begin_inset Formula $\mathbf{W}$
\end_inset

 have the same pattern of sparsity.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:PQN"

\end_inset

Projected quasi-Newton method
\end_layout

\begin_layout Standard
Our idea is to employ the following projected quasi-Newton step
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{R}^{k+1}=\mbox{proj}_{K}\left[\mathbf{R}^{k}-\mathbf{A}^{-1}\mathbf{C}_{\omega}\left(\mathbf{R}^{k}\right)\right]\label{eq:newton}
\end{equation}

\end_inset

where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{A}\simeq\nabla\mathbf{C}_{\omega}\left(\mathbf{R}^{k}\right)
\end{equation}

\end_inset

is an approximation of 
\begin_inset Formula $\nabla\mathbf{C}_{\omega}$
\end_inset

.
 Since in many practical situations 
\begin_inset Formula $\nabla\mathbf{C}_{\omega}$
\end_inset

 is singular (locally or globally there may be more constraints than kinematic
 freedom), we cannot hope for directly employing 
\begin_inset Formula $\nabla\mathbf{C}_{\omega}$
\end_inset

.
 The projection is required by (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:C1"

\end_inset

), so that the iterates remain within the friction cone.
 For the sake of simplicity the only strategy that we wish to use to achieve
 a global convergence is the combination of the projection and a suitable
 choice of 
\begin_inset Formula $\mathbf{A}$
\end_inset

.
\end_layout

\begin_layout Standard
Perhaps the simplest regularization of 
\begin_inset Formula $\nabla\mathbf{C}_{\omega}$
\end_inset

 is a diagonal perturbation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{A}=\nabla\mathbf{C}_{\omega}+\delta\mathbf{I}
\end{equation}

\end_inset

where 
\begin_inset Formula $\delta>0$
\end_inset

.
 After combining it with an approximate, iterative inversion of 
\begin_inset Formula $\mathbf{A}$
\end_inset

, we end up with the following projected quasi-Newton step
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{R}^{k+1}=\mbox{proj}_{K}\left[\mathbf{R}^{k}-\left(\nabla\mathbf{C}_{\omega}^{k}+\delta\mathbf{I}\right)_{\mbox{GMRES}\left(\epsilon\left\Vert \mathbf{C}_{\omega}^{k}\right\Vert ,m\right)}^{-1}\mathbf{C}_{\omega}^{k}\right]
\end{equation}

\end_inset

where by 
\begin_inset Formula $\mathbf{C}_{\omega}^{k}$
\end_inset

 and 
\begin_inset Formula $\nabla\mathbf{C}_{\omega}^{k}$
\end_inset

 we mean the values taken at 
\begin_inset Formula $\mathbf{R}^{k}$
\end_inset

.
 In more detail the above formula is presented as Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:PQN"

\end_inset

.
 In step (a) we update the velocity 
\begin_inset Formula $\mathbf{U}^{k}$
\end_inset

.
 This is needed in order to compute 
\begin_inset Formula $\mathbf{C}_{\omega}^{k}$
\end_inset

 and 
\begin_inset Formula $\nabla\mathbf{C}_{\omega}^{k}$
\end_inset

 in step (b).
 The GMRES solver runs with the absolute accuracy 
\begin_inset Formula $\epsilon\left\Vert \mathbf{C}_{\omega}^{k}\right\Vert $
\end_inset

 and the iterations bound 
\begin_inset Formula $m$
\end_inset

 in step (c).
 Importantly, GMRES is preconditioned with inverted diagonal 
\begin_inset Formula $3\times3$
\end_inset

 blocks of 
\begin_inset Formula $\mathbf{A}$
\end_inset

.
 Finally the projection step follows in (d).
 We note, that the parallel communication is required in steps (a) and (c)
 for the matrix-vector products, and in the last line of the algorithm to
 add up values of 
\begin_inset Formula $g\left(\mathbf{R}^{k}\right)$
\end_inset

 from different processors.
\end_layout

\begin_layout Standard
No numerical scheme is 100% robust and in the last line of Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:PQN"

\end_inset

 we fall back on the Gauss-Seidel scheme 
\begin_inset CommandInset citation
LatexCommand citep
key "Koziara2010"

\end_inset

 when Newton iterations fail.
 Quality of contact solution often depends on the quality of contact points
 and it is not uncommon that ill-conditioned or contradictory contact points
 are produced in multibody simulations.
 In such cases the Gauss-Seidel scheme generates a good approximate solution,
 while the Newton solver may have terminated rather far off.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Description
PQN(
\begin_inset Formula $\mathbf{R},\gamma,n,\omega,\delta,m,\epsilon$
\end_inset

):
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\triangle\mathbf{R}^{0}=\mathbf{0}$
\end_inset

, 
\begin_inset Formula $k=0$
\end_inset

.
\end_layout

\begin_layout Enumerate
Do
\begin_inset Separator latexpar
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathbf{U}^{k}=\mathbf{W}\mathbf{R}^{k}+\mathbf{B}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Compute 
\begin_inset Formula $\mathbf{C}_{\omega}^{k}$
\end_inset

 and 
\begin_inset Formula $\mathbf{A}^{k}=\nabla\mathbf{C}_{\omega}^{k}+\delta\mathbf{I}$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\triangle\mathbf{R}^{k}=\left(\mathbf{A}^{k}\right)_{\mbox{GMRES}\left(\epsilon\left\Vert \mathbf{C}_{\omega}^{k}\right\Vert ,m\right)}^{-1}\mathbf{C}_{\omega}^{k}$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{R}^{k+1}=\mbox{proj}_{K}\left[\mathbf{R}^{k}-\triangle\mathbf{R}^{k}\right]$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $k=k+1$
\end_inset

.
\end_layout

\begin_layout Plain Layout
while 
\begin_inset Formula $g\left(\mathbf{R}^{k}\right)\ge\gamma$
\end_inset

 and 
\begin_inset Formula $k<n$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Enumerate
If 
\begin_inset Formula $k=n$
\end_inset

 then use the Gauss-Seidel solver from 
\begin_inset CommandInset citation
LatexCommand citep
key "Koziara2010"

\end_inset

.
\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:PQN"

\end_inset

The projected quasi-Newton method.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We do not attempt to analyze the convergence of the presented scheme.
 From our experience, proofs of global convergence for nonmonotone problems
 (
\begin_inset Formula $\mu>0$
\end_inset

) rarely bear relevance to numerical practice.
 On the other hand, for well behaved problems (
\begin_inset Formula $\mu=0$
\end_inset

) almost all methods work, be it smooth or nonsmooth.
 For completeness we mention that the globalization strategy adopted here
 has been analyzed under the name of pseudo-transient continuation 
\begin_inset CommandInset citation
LatexCommand citep
key "Kelley1998"

\end_inset

.
\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Examples"

\end_inset

Examples
\end_layout

\begin_layout Standard
Two examples are presented: a rotating drum of rigid or pseudo-rigid ellipsoids
 and a sine sweep excitation of stacked finite element cubes.
 In the examples, when not mentioned otherwise, default parameters from
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:defs"

\end_inset

 are employed in Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:PQN"

\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="8">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\omega$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\delta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\epsilon$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
GMRES restart
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MV products
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1E-8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1000
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mbox{1E-3}\cdot\gamma$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
100000
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:defs"

\end_inset

Default parameter values for Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:PQN"

\end_inset

.
 GMRES restart corresponds to the fixed size of the Krylov subspace used
 by the GMRES solver.
 MV products is the upper bound on the total number of matrix-vector products
 performed by GMRES.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Rotating drum of rigid and pseudo-rigid ellipsoids
\end_layout

\begin_layout Standard
This example illustrates motion of particles inside of a rotating drum.
 The drum geometry is depicted in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum0"

\end_inset

 (a): the drum is made out of a hollow pipe of inner radius 1.0m and thickness
 0.05m, spanned between points 
\begin_inset Formula $\left(0,0,0\right)$
\end_inset

 and 
\begin_inset Formula $\left(0,0.5,0\right)$
\end_inset

, and subdivided into 32 flat pieces.
 There are two rectilinear blocks, centered at points 
\begin_inset Formula $\left(-0.9,0.25,0\right)$
\end_inset

 and 
\begin_inset Formula $\left(0.9,0.25,0\right)$
\end_inset

, of size 
\begin_inset Formula $0.2\times0.5\times0.2$
\end_inset

 along the x, y, z directions.
 The drum is modeled as an obstacle - meaning that its mass is not contributing
 to the simulated physics of the problem.
 Two side walls are used to prevent falling out of particles (disk shaped
 obstacles, not shown in the figure).
 There are two stages of the simulation: dropping down the particles and
 rotating the drum.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum0"

\end_inset

 (b) illustrates the particle dropping stage: the user specifies the number
 of particles 
\begin_inset Formula $N$
\end_inset

 and the radii of the particles is determined as follows:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
r_{0}=(0.1/N)^{1/3},\,r_{x}=0.9r_{0},r_{y}=0.5r_{0},r_{z}=r_{0},\,r_{1}=\frac{r_{x}+r_{y}+r_{z}}{3}
\]

\end_inset

where 
\begin_inset Formula $r_{x}$
\end_inset

, 
\begin_inset Formula $r_{y}$
\end_inset

, 
\begin_inset Formula $r_{z}$
\end_inset

 are the radii of ellipsoidal particles and 
\begin_inset Formula $r_{1}$
\end_inset

 is a radii of spherical particles (when used below).
 Particles are first dropped in layers until all 
\begin_inset Formula $N$
\end_inset

 of them are inserted into the simulation.
 Then rotation begins.
 The total simulation time is 
\begin_inset Formula $10$
\end_inset

 seconds and the time step is 
\begin_inset Formula $0.001$
\end_inset

 second (unless specified otherwise).
 The particle material parameters are 
\begin_inset Formula $E=1\text{E6Pa}$
\end_inset

, 
\begin_inset Formula $\mu=0.25$
\end_inset

, 
\begin_inset Formula $\rho=100\text{kg}/\text{m}^{3}$
\end_inset

 for the Young modulus, Poisson ratio and mass density, respectively.
 Gravity is 
\begin_inset Formula $\left(0,0,-10\right)$
\end_inset

.
 The angular velocity of rotation is 
\begin_inset Formula $\left(0,1,0\right)\text{rad/s}$
\end_inset

 (unless specified otherwise).
 The Signoroni-Coulomb material model 
\begin_inset CommandInset citation
LatexCommand citep
key "Jean01"

\end_inset

 is used and the coefficient of friction is 
\begin_inset Formula $0.3$
\end_inset

.
 Two kinematic models are used in this example: rigid and pseudo-rigid 
\begin_inset CommandInset citation
LatexCommand citep
key "CM88"

\end_inset

.
 In the latter case the rotation matrix of the rigid model is replaced by
 a 
\begin_inset Formula $3\times3$
\end_inset

 linear transformation (per-body deformation gradient) and hence ellipsoids
 deform linearly (develop constant strain/stress).
 When labeling results reported below by 
\emph on
ell.
 rigid
\emph default
 we mean simulations involving rigid ellipsoids, while by 
\emph on
ell.
 defo
\emph default
 we mean simulations involving pseudo-rigid ellipsoids; 
\emph on
sph.
 rigid
\emph default
 and 
\emph on
sph.
 defo
\emph default
 are used analogously when spherical particles are used instead.
 The elliptical pseudo-rigid particles (
\emph on
ell.
 defo
\emph default
) actually deform: their geometry is updated based on the current deformation
 gradient.
 The spherical pseudo-rigid particles (
\emph on
shp.
 defo
\emph default
) are updated in a simplified manner: their initial spherical shape is retained.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename drum0a.png
	lyxscale 20
	width 22text%

\end_inset

(b)
\begin_inset Graphics
	filename drum0b.png
	lyxscale 20
	width 22text%

\end_inset

(c)
\begin_inset Graphics
	filename drum0c.png
	lyxscale 20
	width 22text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum0"

\end_inset

Rotating drum: drum geometry and simulation stages: (a) empty drum, (b)
 dropping down the particles, (c) rotating the drum.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename dru100_RG_A0.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_A1.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_A2.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(b)
\begin_inset Graphics
	filename dru100_RG_B0.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_B1.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_B2.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(c)
\begin_inset Graphics
	filename dru100_RG_C0.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_C1.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_C2.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum1"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\emph on
ell.
 rigid
\emph default
): sensitivity to the choice of 
\begin_inset Formula $\delta$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $\epsilon$
\end_inset

; case (a) is for 
\begin_inset Formula $m=1000$
\end_inset

 and varying 
\begin_inset Formula $\delta,\epsilon$
\end_inset

; case (b) is for 
\begin_inset Formula $\epsilon=10^{-3}$
\end_inset

 and varying 
\begin_inset Formula $m,\delta;$
\end_inset

 case (c) is for varying 
\begin_inset Formula $\left(\epsilon,m\right)$
\end_inset

 pairs and 
\begin_inset Formula $\delta$
\end_inset

; left to right we have: total iterations counts across the entire simulation,
 average numbers of solver iterations per time step when iterations are
 converged, and total (per simulation) number of diverged Newton solver
 runs (when the Gauss-Seidel solver was invoked upon reaching the iteration
 limit); missing dots in the rightmost figures correspond to no cases of
 divergence.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename dru100_PR_A0.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_A1.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_A2.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(b)
\begin_inset Graphics
	filename dru100_PR_B0.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_B1.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_B2.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(c)
\begin_inset Graphics
	filename dru100_PR_C0.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_C1.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_C2.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum2"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\emph on
ell.
 defo
\emph default
): sensitivity to the choice of 
\begin_inset Formula $\delta$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $\epsilon$
\end_inset

; sensitivity to the choice of 
\begin_inset Formula $\delta$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $\epsilon$
\end_inset

; case (a) is for 
\begin_inset Formula $m=1000$
\end_inset

 and varying 
\begin_inset Formula $\delta,\epsilon$
\end_inset

; case (b) is for 
\begin_inset Formula $\epsilon=10^{-3}$
\end_inset

 and varying 
\begin_inset Formula $m,\delta;$
\end_inset

 case (c) is for varying 
\begin_inset Formula $\left(\epsilon,m\right)$
\end_inset

 pairs and 
\begin_inset Formula $\delta$
\end_inset

; left to right we have: total iterations counts across the entire simulation,
 average numbers of solver iterations per time step when iterations are
 converged, and total (per simulation) number of diverged Newton solver
 runs (when the Gauss-Seidel solver was invoked upon reaching the iteration
 limit); missing dots in the rightmost figures correspond to no cases of
 divergence.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(i)
\begin_inset Graphics
	filename dru100_RG_A_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_B_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_C_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(ii)
\begin_inset Graphics
	filename dru100_RG_A_ratios.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_B_ratios.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_C_ratios.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum3"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\emph on
ell.
 rigid
\emph default
): runtimes (i) and solver time to runtime ratios (ii); left to right figures
 correspond to cases (a-c) in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum1"

\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(i)
\begin_inset Graphics
	filename dru100_PR_A_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_B_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_C_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(ii)
\begin_inset Graphics
	filename dru100_PR_A_ratios.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_B_ratios.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_C_ratios.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum4"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\emph on
ell.
 defo
\emph default
): runtimes (i) and solver time to runtime ratios (ii); left to right figures
 correspond to cases (a-c) in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum2"

\end_inset

.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "subsec:absdelta"

\end_inset

Sensitivity study: absolute 
\begin_inset Formula $\delta$
\end_inset

 values
\end_layout

\begin_layout Standard
In this section the number of particles 
\begin_inset Formula $N=100$
\end_inset

.
 Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum2"

\end_inset

 depict sensitivity of the solver iteration counts to the choice of 
\begin_inset Formula $\delta$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $\epsilon$
\end_inset

.
 In case (a) the linear solver iterations bound 
\begin_inset Formula $m=1000$
\end_inset

 and hence the linear solve accuracy is dictated by the choice of 
\begin_inset Formula $\epsilon$
\end_inset

.
 In this case generally, the more inexact the linear solve is the more robust
 the solver behavior becomes: both the total and average numbers of iterations
 are lowest for 
\begin_inset Formula $\epsilon\in\left\{ 0.1,0.25\right\} $
\end_inset

; for the rigid body case, with 
\begin_inset Formula $\delta=0.001$
\end_inset

, the are no cases of divergence for these two values of 
\begin_inset Formula $\epsilon$
\end_inset

; in the deformable case the entire vertical strip at 
\begin_inset Formula $\delta=0.001$
\end_inset

 has this property and also there is no divergence for several other combination
s of 
\begin_inset Formula $\delta$
\end_inset

 and 
\begin_inset Formula $\epsilon$
\end_inset

.
 In case (b) the absolute accuracy of the linear solver is kept constant
 at 
\begin_inset Formula $\epsilon=0.001$
\end_inset

 while the number of linear solver iterations 
\begin_inset Formula $m$
\end_inset

 is varied.
 In this case it is also clear that inexact solves are favorable, with lowest
 total and average numbers of iterations for 
\begin_inset Formula $m\in\left\{ 10,15\right\} $
\end_inset

 for both the rigid and deformable case.
 There are no solver failures for 
\begin_inset Formula $\delta=0.001$
\end_inset

 and 
\begin_inset Formula $m\in\left\{ 3,5\right\} $
\end_inset

 in the rigid case, while a significantly larger set of parameters 
\begin_inset Formula $m\in\left\{ 3,5\right\} $
\end_inset

 
\series bold
or
\series default
 
\begin_inset Formula $\delta\in\left\{ 0.001,0.01\right\} $
\end_inset

 is divergence free (with an exception of one data point).
 Hence clearly inexact linear solves are favored, case (c) samples sensitivity
 in the space of various 
\begin_inset Formula $\left(\epsilon,m\right)$
\end_inset

 choices and the regularization parameter 
\begin_inset Formula $\delta$
\end_inset

.
 In the rigid case (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum1"

\end_inset

 (c), right) it is seen that the entire 
\begin_inset Formula $\delta=0.001$
\end_inset

 is nearly free of solver divergence; a significantly large parameter space
 has this property in the deformable case (Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum2"

\end_inset

 (c), right).
 We can also see that for the rigid case the average number of iterations
 per time step is in the range 10-100, while in the deformable case it is
 in the range 1-10.
 Consequently, there is a similar correspondence between the total number
 of iterations (scaled up by 10000: the number of time steps).
\end_layout

\begin_layout Standard
The runtimes and solver time to runtime ratios are depicted in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum3"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum4"

\end_inset

.
 Shortest runtimes and lowest timing ratios correspond to the same parameter
 set choices as those transpiring in Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum2"

\end_inset

.
 For the rigid body case, the choice of 
\begin_inset Formula $\left(0.0001,0.1,15\right)$
\end_inset

 for the 
\begin_inset Formula $\left(\delta,\epsilon,m\right)$
\end_inset

 triad produces the shortest total runtime of 
\begin_inset Note Note
status open

\begin_layout Plain Layout
452s
\end_layout

\end_inset

 (less then ten solver failures occur in this case).
 For the pseudo-rigid kinematic case, the choice of 
\begin_inset Formula $\left(1\text{E-6},0.1,1000\right)$
\end_inset

 for the 
\begin_inset Formula $\left(\delta,\epsilon,m\right)$
\end_inset

 triad produces the shortest total runtime of 
\begin_inset Note Note
status open

\begin_layout Plain Layout
318s
\end_layout

\end_inset

 (one solver failure occurs in this case).
 These runtimes are well comparable with those produced by the Gauss-Seidel
 solver based runs and reported in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:drum1"

\end_inset

.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO: rerun the study in order to produce consistent runtimes with those
 in the table (these above are for the previous, gradual way of inserting
 the particles)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="9">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Newton solver based
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gauss-Seidel solver based
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
runtime
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ratio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
it/step
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
divs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
runtime
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ratio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
it/step
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
divs
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ell.
 rigid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
599
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
526
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
119
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
31
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ell.
 defo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
421
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
453
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.45
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sph.
 rigid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
242
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
406
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.94
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
164
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
180
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sph.
 defo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
199
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
55
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
19
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:drum1"

\end_inset

Rotating drum 
\begin_inset Formula $\left(N=100\right)$
\end_inset

: comparison of solution statistics for 
\begin_inset Formula $\left(\delta,\epsilon,m\right)$
\end_inset

 choice of 
\begin_inset Formula $\left(0.0001,0.1,15\right)$
\end_inset

 for the rigid body case and 
\begin_inset Formula $\left(1\text{E-6},0.1,1000\right)$
\end_inset

 for the deformable body case; respective columns stand for total runtime
 in seconds (runtime), solver time to runtime ratio (ratio), average number
 of iterations per step when converged (it/step), and number of diverged
 steps.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
\begin_inset CommandInset label
LatexCommand label
name "subsec:reldelta"

\end_inset

Sensitivity study: relative 
\begin_inset Formula $\delta$
\end_inset

 values
\end_layout

\begin_layout Standard
The choice of the regularization parameter 
\begin_inset Formula $\delta$
\end_inset

 as an absolute value may not always be practical.
 For simulation setups with many particles it may not be possible to run
 many large scale tests in order to tune 
\begin_inset Formula $\delta.$
\end_inset

 It may be more practical to study solver performance on a smaller example,
 just like in this section, and then attempt to reuse the set of recommended
 parameters for larger scale runs.
 This is why investigating a choice of 
\begin_inset Formula $\delta$
\end_inset

 as relative to a norm of the 
\begin_inset Formula $\mathbf{W}$
\end_inset

 operator (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:W"

\end_inset

) is relevant.
 Three such choices are investigated here:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\delta_{1}=\delta\cdot\min_{i}W_{ii}\text{ or }\delta_{1}=\delta\cdot\underset{i}{\text{avg}}W_{ii}\text{ or }\delta_{1}=\delta\cdot\max_{i}W_{ii}
\]

\end_inset

where 
\begin_inset Formula $W_{ii}$
\end_inset

 are the diagonal entries of 
\begin_inset Formula $\mathbf{W}$
\end_inset

.
 Consequently, 
\begin_inset Formula $\delta_{1}$
\end_inset

 is used in line 2b of Algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:PQN"

\end_inset

 instead of 
\begin_inset Formula $\delta$
\end_inset

.
 The same studies as in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:absdelta"

\end_inset

 are repeated in the current case.
 The results are juxtaposed below.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename dru100_RG_A_minWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_A1_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_A2_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(b)
\begin_inset Graphics
	filename dru100_RG_B_minWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_B1_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_B2_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(c)
\begin_inset Graphics
	filename dru100_RG_C_minWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_C1_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_C2_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum1-minWii"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\emph on
ell.
 rigid
\emph default
, 
\begin_inset Formula $\delta_{1}=\delta\cdot\min_{i}W_{ii}$
\end_inset

): sensitivity to the choice of 
\begin_inset Formula $\delta$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $\epsilon$
\end_inset

; case (a) is for 
\begin_inset Formula $m=1000$
\end_inset

 and varying 
\begin_inset Formula $\delta,\epsilon$
\end_inset

; case (b) is for 
\begin_inset Formula $\epsilon=10^{-3}$
\end_inset

 and varying 
\begin_inset Formula $m,\delta;$
\end_inset

 case (c) is for varying 
\begin_inset Formula $\left(\epsilon,m\right)$
\end_inset

 pairs and 
\begin_inset Formula $\delta$
\end_inset

; left to right we have: total runtimes, average numbers of solver iterations
 per time step when iterations are converged, and total (per simulation)
 number of diverged Newton solver runs (when the Gauss-Seidel solver was
 invoked upon reaching the iteration limit); missing dots in the rightmost
 figures correspond to no cases of divergence.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename dru100_RG_A_avgWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_A1_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_A2_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(b)
\begin_inset Graphics
	filename dru100_RG_B_avgWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_B1_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_B2_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(c)
\begin_inset Graphics
	filename dru100_RG_C_avgWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_C1_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_C2_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum1-avgWii"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\emph on
ell.
 rigid
\emph default
, 
\begin_inset Formula $\delta_{1}=\delta\cdot\underset{i}{\text{avg}}W_{ii}$
\end_inset

): sensitivity to the choice of 
\begin_inset Formula $\delta$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $\epsilon$
\end_inset

; case (a) is for 
\begin_inset Formula $m=1000$
\end_inset

 and varying 
\begin_inset Formula $\delta,\epsilon$
\end_inset

; case (b) is for 
\begin_inset Formula $\epsilon=10^{-3}$
\end_inset

 and varying 
\begin_inset Formula $m,\delta;$
\end_inset

 case (c) is for varying 
\begin_inset Formula $\left(\epsilon,m\right)$
\end_inset

 pairs and 
\begin_inset Formula $\delta$
\end_inset

; left to right we have: total runtimes, average numbers of solver iterations
 per time step when iterations are converged, and total (per simulation)
 number of diverged Newton solver runs (when the Gauss-Seidel solver was
 invoked upon reaching the iteration limit); missing dots in the rightmost
 figures correspond to no cases of divergence.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename dru100_RG_A_maxWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_A1_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_A2_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(b)
\begin_inset Graphics
	filename dru100_RG_B_maxWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_B1_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_B2_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(c)
\begin_inset Graphics
	filename dru100_RG_C_maxWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_C1_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_C2_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum1-maxWii"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\emph on
ell.
 rigid
\emph default
, 
\begin_inset Formula $\delta_{1}=\delta\cdot\max_{i}W_{ii}$
\end_inset

): sensitivity to the choice of 
\begin_inset Formula $\delta$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $\epsilon$
\end_inset

; case (a) is for 
\begin_inset Formula $m=1000$
\end_inset

 and varying 
\begin_inset Formula $\delta,\epsilon$
\end_inset

; case (b) is for 
\begin_inset Formula $\epsilon=10^{-3}$
\end_inset

 and varying 
\begin_inset Formula $m,\delta;$
\end_inset

 case (c) is for varying 
\begin_inset Formula $\left(\epsilon,m\right)$
\end_inset

 pairs and 
\begin_inset Formula $\delta$
\end_inset

; left to right we have: total runtimes, average numbers of solver iterations
 per time step when iterations are converged, and total (per simulation)
 number of diverged Newton solver runs (when the Gauss-Seidel solver was
 invoked upon reaching the iteration limit); missing dots in the rightmost
 figures correspond to no cases of divergence.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename dru100_PR_A_minWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_A1_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_A2_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(b)
\begin_inset Graphics
	filename dru100_PR_B_minWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_B1_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_B2_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(c)
\begin_inset Graphics
	filename dru100_PR_C_minWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_C1_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_C2_minWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum2-minWii"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\emph on
ell.
 defo
\emph default
, 
\begin_inset Formula $\delta_{1}=\delta\cdot\min_{i}W_{ii}$
\end_inset

): sensitivity to the choice of 
\begin_inset Formula $\delta$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $\epsilon$
\end_inset

; case (a) is for 
\begin_inset Formula $m=1000$
\end_inset

 and varying 
\begin_inset Formula $\delta,\epsilon$
\end_inset

; case (b) is for 
\begin_inset Formula $\epsilon=10^{-3}$
\end_inset

 and varying 
\begin_inset Formula $m,\delta;$
\end_inset

 case (c) is for varying 
\begin_inset Formula $\left(\epsilon,m\right)$
\end_inset

 pairs and 
\begin_inset Formula $\delta$
\end_inset

; left to right we have: total runtimes, average numbers of solver iterations
 per time step when iterations are converged, and total (per simulation)
 number of diverged Newton solver runs (when the Gauss-Seidel solver was
 invoked upon reaching the iteration limit); missing dots in the rightmost
 figures correspond to no cases of divergence.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename dru100_PR_A_avgWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_A1_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_A2_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(b)
\begin_inset Graphics
	filename dru100_PR_B_avgWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_B1_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_B2_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(c)
\begin_inset Graphics
	filename dru100_PR_C_avgWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_C1_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_C2_avgWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum2-avgWii"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\emph on
ell.
 defo
\emph default
, 
\begin_inset Formula $\delta_{1}=\delta\cdot\underset{i}{\text{avg}}W_{ii}$
\end_inset

): sensitivity to the choice of 
\begin_inset Formula $\delta$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $\epsilon$
\end_inset

; case (a) is for 
\begin_inset Formula $m=1000$
\end_inset

 and varying 
\begin_inset Formula $\delta,\epsilon$
\end_inset

; case (b) is for 
\begin_inset Formula $\epsilon=10^{-3}$
\end_inset

 and varying 
\begin_inset Formula $m,\delta;$
\end_inset

 case (c) is for varying 
\begin_inset Formula $\left(\epsilon,m\right)$
\end_inset

 pairs and 
\begin_inset Formula $\delta$
\end_inset

; left to right we have: total runtimes, average numbers of solver iterations
 per time step when iterations are converged, and total (per simulation)
 number of diverged Newton solver runs (when the Gauss-Seidel solver was
 invoked upon reaching the iteration limit); missing dots in the rightmost
 figures correspond to no cases of divergence.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename dru100_PR_A_maxWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_A1_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_A2_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(b)
\begin_inset Graphics
	filename dru100_PR_B_maxWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_B1_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_B2_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(c)
\begin_inset Graphics
	filename dru100_PR_C_maxWii_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_C1_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_C2_maxWii.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum2-maxWii"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\emph on
ell.
 defo
\emph default
, 
\begin_inset Formula $\delta_{1}=\delta\cdot\max_{i}W_{ii}$
\end_inset

): sensitivity to the choice of 
\begin_inset Formula $\delta$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, and 
\begin_inset Formula $\epsilon$
\end_inset

; case (a) is for 
\begin_inset Formula $m=1000$
\end_inset

 and varying 
\begin_inset Formula $\delta,\epsilon$
\end_inset

; case (b) is for 
\begin_inset Formula $\epsilon=10^{-3}$
\end_inset

 and varying 
\begin_inset Formula $m,\delta;$
\end_inset

 case (c) is for varying 
\begin_inset Formula $\left(\epsilon,m\right)$
\end_inset

 pairs and 
\begin_inset Formula $\delta$
\end_inset

; left to right we have: total runtimes, average numbers of solver iterations
 per time step when iterations are converged, and total (per simulation)
 number of diverged Newton solver runs (when the Gauss-Seidel solver was
 invoked upon reaching the iteration limit); missing dots in the rightmost
 figures correspond to no cases of divergence.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
By browsing Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum1-minWii"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum2-maxWii"

\end_inset

 we notice that cases of fully robust runs (without divergence) are significantl
y more common when the choice of 
\begin_inset Formula $\delta_{1}$
\end_inset

 is relative to 
\begin_inset Formula $\mathbf{W}$
\end_inset

.
 As we move from the 
\begin_inset Formula $\min W_{ii}$
\end_inset

 norm, through the average 
\begin_inset Formula $W_{ii}$
\end_inset

 norm, to the 
\begin_inset Formula $\max W_{ii}$
\end_inset

 norm, the region of no solver failures gradually moves from right to left
  within the unchanging range of the relative span of 
\begin_inset Formula $\delta$
\end_inset

.
 This reflects the fact that the absolute range of values of 
\begin_inset Formula $\delta_{1}$
\end_inset

 for which no failures occur becomes better represented (within the chosen
 and fixed range of 
\begin_inset Formula $\delta$
\end_inset

) as we shift between 
\begin_inset Formula $\min W_{ii}\rightarrow\text{avg}W_{ii}\rightarrow\max W_{ii}$
\end_inset

.
 Perhaps it does not matter which of those norms we use as long as in our
 investigation of an optimum value of 
\begin_inset Formula $\delta$
\end_inset

 we cover a sufficient range.
 We can also see, that for rigid ellipsoids this range is narrower when
 compared with the deformable counterpart: the no failure zone is significantly
 broader in case of pseudo-rigid ellipsoids.
 This corresponds to the fact that it is easier to resolve contact reactions
 with the extra kinematic freedom for the particles themselves to deform.
\end_layout

\begin_layout Standard
In all of the Figures 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum1-minWii"

\end_inset

-
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:drum2-maxWii"

\end_inset

 the areas of shortest runtimes do not necessarily strictly reflect the
 areas of no solver failure.
 There are overlap zones where both properties meet, but in general shortest
 runtimes occur in areas where both, the average number of solver iterations
 per time step, and the number of solver failures, are simultaneously low.
 Having only few instances of a fallback on the Gauss-Seidel solver during
 the entire simulation does not significantly affect the runtime.
 Nonetheless, it is possible to select parameter sets for which there is
 no solver failure and the runtime is short.
 For the rigid body case, the choice of 
\begin_inset Formula $\left(0.01_{\text{avg}W_{ii}},0.25,20\right)$
\end_inset

 for the 
\begin_inset Formula $\left(\delta_{\text{avg}W_{ii}},\epsilon,m\right)$
\end_inset

 triad produces the shortest total runtime of 482s (no solver failure occurs
 in this case).
 For the pseudo-rigid kinematic case, the choice of 
\begin_inset Formula $\left(0.025_{\text{avg}W_{ii}},0.025,10\right)$
\end_inset

 for the 
\begin_inset Formula $\left(\delta_{\text{avg}W_{ii}},\epsilon,m\right)$
\end_inset

 triad produces the shortest total runtime of 380s (no solver failure also
 in this case).
 These runtimes are well comparable with those produced by the Gauss-Seidel
 solver based runs and reported in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:drum1-reldelta"

\end_inset

 (note also the variation of the Newton based runtimes due to test reruns).
 Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:drum1-normtimes"

\end_inset

 juxtaposes shortest runtimes for all three choices of the relative 
\begin_inset Formula $\delta$
\end_inset

 norms.
 
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO: clarity of rerun variation in tables
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="9">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Newton solver based
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gauss-Seidel solver based
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
runtime
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ratio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
it/step
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
divs
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
runtime
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ratio
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
it/step
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
divs
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ell.
 rigid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
496
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.73
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
526
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.83
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
119
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
31
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
ell.
 defo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
402
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.58
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
453
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.45
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
15
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sph.
 rigid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
271
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.90
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
406
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.94
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
164
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
180
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
sph.
 defo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
123
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.79
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
55
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.75
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
19
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:drum1-reldelta"

\end_inset

Rotating drum 
\begin_inset Formula $\left(N=100\right)$
\end_inset

: comparison of solution statistics for 
\begin_inset Formula $\left(\delta,\epsilon,m\right)$
\end_inset

 choice of 
\begin_inset Formula $\left(0.01_{\text{avg}W_{ii}},0.25,20\right)$
\end_inset

 for the rigid body case and 
\begin_inset Formula $\left(0.025_{\text{avg}W_{ii}},0.025,10\right)$
\end_inset

 for the deformable body case; respective columns stand for total runtime
 in seconds (runtime), solver time to runtime ratio (ratio), average number
 of iterations per step when converged (it/step), and number of diverged
 steps.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="6">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell multicolumn="1" alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
runtime
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\delta$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\epsilon$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
rigid
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\min W_{ii}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
486s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.025
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{avg}W_{ii}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
482s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.25
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
20
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\max$
\end_inset


\begin_inset Formula $W_{ii}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
529s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="3" alignment="center" valignment="middle" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
defo
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\min W_{ii}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
384s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\text{avg}W_{ii}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
380s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.025
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.025
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell multirow="4" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\max$
\end_inset


\begin_inset Formula $W_{ii}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
385s
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.01
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.025
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "tab:drum1-normtimes"

\end_inset

Rotating drum 
\begin_inset Formula $\left(N=100\right)$
\end_inset

: juxtaposition of shortest runtimes and parameter choices for all three
 relative 
\begin_inset Formula $\delta$
\end_inset

 norms.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Sensitivity study: material density vs.
 relative 
\begin_inset Formula $\delta$
\end_inset

 choices
\end_layout

\begin_layout Standard
Small scale simulations like in Sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:absdelta"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:reldelta"

\end_inset

 are suitable for exploring and tuning solver parameters.
 Nonetheless, in case of large scale simulations, such direct tuning would
 not be practical - consuming too much resources and time.
 When modifying aspects of a simulation setup (e.g.
 material parameters, geometrical dimensions, number of particles) it is
 useful to have an orientation whether a set of optimal parameters - for
 a tuned simulation setup - remains approximately optimal for a model that
 has undergone change.
 Here, we explore this by varying material density versus the choice of
 delta for the same model with 100 particles.
 We hope to verify whether the relative choice of delta is robust enough
 to be applied for large scale simulations of the rotating drum: in our
 setup the dimensions of the drum remain unchanged, but particles become
 smaller as their number grows.
 Varying the density of the 100 particles algebraically approximates this
 effect.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename dru100_RG_0_dens.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_1_dens.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_RG_2_dens.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
(b)
\begin_inset Graphics
	filename dru100_PR_0_dens.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_1_dens.png
	lyxscale 33
	width 33text%

\end_inset


\begin_inset Graphics
	filename dru100_PR_2_dens.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum100-dens-stats"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\begin_inset Formula $\left(\delta_{1},\epsilon,m\right)=\left(\delta_{\text{avg}W_{ii}},0.25,20\right)$
\end_inset

 for 
\emph on
ell.
 rigid
\emph default
, 
\begin_inset Formula $\left(\delta_{1},\epsilon,m\right)=\left(\delta_{\text{avg}W_{ii}},0.025,10\right)$
\end_inset

 for 
\emph on
ell.
 defo
\emph default
): sensitivity to the choice of material density and 
\begin_inset Formula $\delta$
\end_inset

; case (a) is for rigid ellipsoids; case (b) is for pseudo-rigid ellipsoids;
 left to right we have: total runtimes, average numbers of solver iterations
 per time step when iterations are converged, and total (per simulation)
 number of diverged Newton solver runs (when the Gauss-Seidel solver was
 invoked upon reaching the iteration limit); missing dots in the rightmost
 figures correspond to no cases of divergence.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
(a)
\begin_inset Graphics
	filename dru100_RG_dens_runtimes.png
	lyxscale 33
	width 33text%

\end_inset

 (b)
\begin_inset Graphics
	filename dru100_PR_dens_runtimes.png
	lyxscale 33
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:drum100-dens-stats-1"

\end_inset

Rotating drum (
\begin_inset Formula $N=100$
\end_inset

, 
\begin_inset Formula $\left(\delta_{1},\epsilon,m\right)=\left(\delta_{\text{avg}W_{ii}},0.25,20\right)$
\end_inset

 for 
\emph on
ell.
 rigid
\emph default
, 
\begin_inset Formula $\left(\delta_{1},\epsilon,m\right)=\left(\delta_{\text{avg}W_{ii}},0.025,10\right)$
\end_inset

 for 
\emph on
ell.
 defo
\emph default
): sensitivity of the total runtime to the choice of material density and
 
\begin_inset Formula $\delta$
\end_inset

; case (a) is for rigid ellipsoids; case (b) is for pseudo-rigid ellipsoids.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Larger scale parallel runs
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Sine sweep excitation of stacked finite element cubes
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Small scale serial runs
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Larger scale parallel runs
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO
\end_layout

\end_inset


\end_layout

\begin_layout Section
\begin_inset CommandInset label
LatexCommand label
name "sec:Conclusions"

\end_inset

Conclusions
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO
\end_layout

\end_inset


\end_layout

\begin_layout Section
\start_of_appendix
Appendix - Derivative of the smoothed projection onto the polar cone
\begin_inset CommandInset label
LatexCommand label
name "sec:Derivative"

\end_inset


\end_layout

\begin_layout Standard
The projection operator as defined in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:proj_K_po"

\end_inset

) is nonsmooth.
 Motivated by 
\begin_inset CommandInset citation
LatexCommand citep
key "Fukushima2002,Hayashi2005"

\end_inset

 we employ the following smoothing
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mbox{proj}_{K^{\circ}}^{\omega}\left(\mathbf{z}\right)=\kappa_{1}\omega g\left(\lambda_{1}/\left(\kappa_{1}\omega\right)\right)\mathbf{u}_{1}+\kappa_{2}\omega g\left(\lambda_{2}/\left(\kappa_{2}\omega\right)\right)\mathbf{u}_{2}\label{eq:proj_K_ps_1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\kappa_{1}>0$
\end_inset

 and 
\begin_inset Formula $\kappa_{2}>0$
\end_inset

 and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
g\left(\lambda\right)=\frac{1}{2}\left(\sqrt{\lambda^{2}+4}+\lambda\right)\mbox{.}\label{eq:g_1}
\end{equation}

\end_inset

The smoothing function 
\begin_inset Formula $\omega g\left(\lambda/\omega\right)$
\end_inset

 is differentiable for all 
\begin_inset Formula $\omega>0$
\end_inset

 and it converges to 
\begin_inset Formula $\max\left(0,\lambda\right)$
\end_inset

 when 
\begin_inset Formula $\omega\downarrow0$
\end_inset

.
 We derive gradient of 
\begin_inset Formula $\mbox{proj}_{K^{\circ}}^{\omega}\left(\mathbf{z}\right)$
\end_inset

 as defined in (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:proj_K_ps_1"

\end_inset

).
 This is a repetition of the derivation provided by Fukushima et al.
 
\begin_inset CommandInset citation
LatexCommand citep
key "Fukushima2002"

\end_inset

 (Proposition 5.2), adjusted to the case of a non self-dual cone.
 To compute 
\begin_inset Formula $\nabla\mbox{proj}_{K^{\circ}}^{\omega}\left(\mathbf{z}\right)$
\end_inset

 we need to consider two cases, 
\begin_inset Formula $\mathbf{z}_{T}\ne\mathbf{0}$
\end_inset

 and 
\begin_inset Formula $\mathbf{z}_{T}=\mathbf{0}$
\end_inset

.
 Since there holds 
\begin_inset Formula 
\begin{equation}
\mbox{proj}_{K^{\circ}}^{\omega}\left(\mathbf{z}\right)=\omega h\left(\mathbf{z}/\omega\right)\mbox{ and thus }\nabla\mbox{proj}_{K^{\circ}}^{\omega}\left(\mathbf{z}\right)=\nabla h\left(\mathbf{z}/\omega\right)
\end{equation}

\end_inset

where 
\begin_inset Formula 
\begin{equation}
h\left(\mathbf{z}\right)=\kappa_{1}g\left(\lambda_{1}/\kappa_{1}\right)\mathbf{u}_{1}+\kappa_{2}g\left(\lambda_{2}/\kappa_{2}\right)\mathbf{u}_{2}\mbox{,}
\end{equation}

\end_inset

it is enough to compute 
\begin_inset Formula $\nabla h$
\end_inset

.
\end_layout

\begin_layout Subsection*
Case 
\begin_inset Formula $\mathbf{z}_{T}\ne\mathbf{0}$
\end_inset


\end_layout

\begin_layout Standard
We have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla_{\mathbf{z}}\lambda_{i}=\frac{1}{1+\mu^{2}}\mathbf{u}_{1},\,\,\,i=1,2
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla_{\mathbf{z}}\mathbf{u}_{1}=\frac{-\mu}{\left\Vert \mathbf{z}_{T}\right\Vert }\left[\begin{array}{cc}
\mathbf{I}-\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2} & 0\\
0 & 0
\end{array}\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla_{\mathbf{z}}\mathbf{u}_{2}=\frac{1}{\left\Vert \mathbf{z}_{T}\right\Vert }\left[\begin{array}{cc}
\mathbf{I}-\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2} & 0\\
0 & 0
\end{array}\right]
\end{equation}

\end_inset

and hence
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\nabla h\left(\mathbf{z}\right) & = & \kappa_{1}g\left(\lambda_{1}/\kappa_{1}\right)\nabla_{\mathbf{z}}\mathbf{u}_{1}+\dot{g}\left(\lambda_{1}/\kappa_{2}\right)\mathbf{u}_{1}\left(\nabla_{\mathbf{z}}\lambda_{1}\right)^{T}\\
 & + & \kappa_{2}g\left(\lambda_{2}/\kappa_{2}\right)\nabla_{\mathbf{z}}\mathbf{u}_{2}+\dot{g}\left(\lambda_{2}/\kappa_{2}\right)\mathbf{u}_{2}\left(\nabla_{\mathbf{z}}\lambda_{2}\right)^{T}\\
 & = & \frac{\kappa_{2}g\left(\lambda_{2}/\kappa_{2}\right)-\mu\kappa_{1}g\left(\lambda_{1}/\kappa_{1}\right)}{\left\Vert \mathbf{z}_{T}\right\Vert }\left[\begin{array}{cc}
\mathbf{I}-\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert  & 0\\
0 & 0
\end{array}\right]\\
 & + & \frac{1}{1+\mu^{2}}\left[\dot{g}\left(\lambda_{1}/\kappa_{1}\right)\mathbf{u}_{1}\mathbf{u}_{1}^{T}+\dot{g}\left(\lambda_{2}/\kappa_{2}\right)\mathbf{u}_{2}\mathbf{u}_{2}^{T}\right]\mbox{.}
\end{eqnarray*}

\end_inset

There hold
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{u}_{1}\mathbf{u}_{1}^{T}=\left[\begin{array}{cc}
\mu^{2}\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2} & \mu\mathbf{z}_{T}/\left\Vert \mathbf{z}_{T}\right\Vert \\
\mu\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert  & 1
\end{array}\right]
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\mathbf{u}_{2}\mathbf{u}_{2}^{T}=\left[\begin{array}{cc}
\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2} & -\mu\mathbf{z}_{T}/\left\Vert \mathbf{z}_{T}\right\Vert \\
-\mu\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert  & \mu^{2}
\end{array}\right]
\end{equation}

\end_inset

so that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\nabla h & = & \frac{\kappa_{2}g\left(\lambda_{2}/\kappa_{2}\right)-\mu\kappa_{1}g\left(\lambda_{1}/\kappa_{1}\right)}{\left\Vert \mathbf{z}_{T}\right\Vert }\left[\begin{array}{cc}
\mathbf{I}-\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2} & 0\\
0 & 0
\end{array}\right]\\
 &  & \frac{1}{1+\mu^{2}}\left[\begin{array}{cc}
\left(\mu^{2}\dot{g}\left(\lambda_{1}/\kappa_{1}\right)+\dot{g}\left(\lambda_{2}/\kappa_{2}\right)\right)\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2} & \mu\left(\dot{g}\left(\lambda_{1}/\kappa_{1}\right)-\dot{g}\left(\lambda_{2}/\kappa_{2}\right)\right)\mathbf{z}_{T}/\left\Vert \mathbf{z}_{T}\right\Vert \\
\mu\left(\dot{g}\left(\lambda_{1}/\kappa_{1}\right)-\dot{g}\left(\lambda_{2}/\kappa_{2}\right)\right)\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert  & \dot{g}\left(\lambda_{1}/\kappa_{1}\right)+\mu^{2}\dot{g}\left(\lambda_{2}/\kappa_{2}\right)
\end{array}\right]
\end{eqnarray*}

\end_inset

and by taking
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
a=\frac{\kappa_{2}g\left(\lambda_{2}/\kappa_{2}\right)-\mu\kappa_{1}g\left(\lambda_{1}/\kappa_{1}\right)}{\left\Vert \mathbf{z}_{T}\right\Vert },b=\frac{\mu^{2}\dot{g}\left(\lambda_{1}/\kappa_{1}\right)+\dot{g}\left(\lambda_{2}/\kappa_{2}\right)}{1+\mu^{2}}
\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
c=\frac{\mu\left(\dot{g}\left(\lambda_{1}/\kappa_{1}\right)-\dot{g}\left(\lambda_{2}/\kappa_{2}\right)\right)}{1+\mu^{2}},d=\frac{\dot{g}\left(\lambda_{1}/\kappa_{1}\right)+\mu^{2}\dot{g}\left(\lambda_{2}/\kappa_{2}\right)}{1+\mu^{2}}
\end{equation}

\end_inset

we obtain
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\nabla h\left(\mathbf{z}\right)=\left[\begin{array}{cc}
a\mathbf{I}+\left(b-a\right)\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2} & c\mathbf{z}_{T}/\left\Vert \mathbf{z}_{T}\right\Vert \\
c\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert  & d
\end{array}\right]\mbox{.}
\end{equation}

\end_inset

We now need to ensure that 
\begin_inset Formula $\nabla h$
\end_inset

 is invertible, which is done along Proposition 6.1 in 
\begin_inset CommandInset citation
LatexCommand citep
key "Fukushima2002"

\end_inset

 or Proposition 3.1 in 
\begin_inset CommandInset citation
LatexCommand citep
key "Hayashi2005"

\end_inset

.
 Since 
\begin_inset Formula $d$
\end_inset

 is positive it is enough to show that the Schur complement of 
\begin_inset Formula $\nabla h$
\end_inset

 with respect to 
\begin_inset Formula $d$
\end_inset

 is also positive definite.
 The Schur complement with respect to 
\begin_inset Formula $d$
\end_inset

 reads
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left\{ a\mathbf{I}+\left(b-a\right)\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2}\right\} -c^{2}\mathbf{z}_{T}\mathbf{z}_{T}^{T}/d\left\Vert \mathbf{z}_{T}\right\Vert ^{2}=a\left(\mathbf{I}-\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2}\right)+\frac{bd-c^{2}}{d}\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2}\mbox{.}
\]

\end_inset

Both 
\begin_inset Formula $\mathbf{I}-\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2}$
\end_inset

 and 
\begin_inset Formula $\mathbf{z}_{T}\mathbf{z}_{T}^{T}/\left\Vert \mathbf{z}_{T}\right\Vert ^{2}$
\end_inset

 are positive semidefinite and their sum is identity.
 Hence any positive linear combination of these two matrices is itself positive
 definite.
 We now need to show that 
\begin_inset Formula $a>0$
\end_inset

 and that 
\begin_inset Formula $bd-c^{2}>0$
\end_inset

.
 For 
\begin_inset Formula $a>0$
\end_inset

 it is necessary that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\kappa_{2}g\left(\lambda_{2}/\kappa_{2}\right)-\mu\kappa_{1}g\left(\lambda_{1}/\kappa_{1}\right)>0
\]

\end_inset

which is the case if only
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\lambda_{2}/\kappa_{2}>\lambda_{1}/\kappa_{1}\mbox{ and }\kappa_{2}\ge\mu\kappa_{1}\mbox{.}
\]

\end_inset

From (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:l12"

\end_inset

) we notice that 
\begin_inset Formula $\left\Vert \mathbf{z}_{T}\right\Vert =\lambda_{2}-\mu\lambda_{1}$
\end_inset

.
 Hence 
\begin_inset Formula $\lambda_{2}>\mu\lambda_{1}$
\end_inset

 and above conditions are most naturally fulfilled for
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\kappa_{1}=1\mbox{ and }\kappa_{2}=\mu
\]

\end_inset

or
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\kappa_{1}=\mu^{-1}\mbox{ and }\kappa_{2}=1\mbox{.}
\]

\end_inset

Let us now check how these choices affect the condition 
\begin_inset Formula $bd-c^{2}>0$
\end_inset

.
 We have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
\left(bd-c^{2}\right)\left(1+\mu^{2}\right)^{2} & = & \left(\mu^{2}\dot{g}\left(\lambda_{1}/\kappa_{1}\right)+\dot{g}\left(\lambda_{2}/\kappa_{2}\right)\right)\left(\dot{g}\left(\lambda_{1}/\kappa_{1}\right)+\mu^{2}\dot{g}\left(\lambda_{2}/\kappa_{2}\right)\right)\\
 & - & \left(\mu\left(\dot{g}\left(\lambda_{1}/\kappa_{1}\right)-\dot{g}\left(\lambda_{2}/\kappa_{2}\right)\right)\right)^{2}\\
 & = & \mu^{2}\dot{g}^{2}\left(\lambda_{1}/\kappa_{1}\right)+\mu^{4}\dot{g}\left(\lambda_{1}/\kappa_{1}\right)\dot{g}\left(\lambda_{2}/\kappa_{2}\right)+\dot{g}\left(\lambda_{1}/\kappa_{1}\right)\dot{g}\left(\lambda_{2}/\kappa_{2}\right)+\mu^{2}\dot{g}^{2}\left(\lambda_{2}/\kappa_{2}\right)\\
 & - & \left(\mu^{2}\dot{g}^{2}\left(\lambda_{1}/\kappa_{1}\right)-2\mu^{2}\dot{g}\left(\lambda_{1}/\kappa_{1}\right)\dot{g}\left(\lambda_{2}/\kappa_{2}\right)+\mu^{2}\dot{g}^{2}\left(\lambda_{2}/\kappa_{2}\right)\right)\\
 & = & \left(\mu^{4}+2\mu^{2}+1\right)\dot{g}\left(\lambda_{1}/\kappa_{1}\right)\dot{g}\left(\lambda_{2}/\kappa_{2}\right)
\end{eqnarray*}

\end_inset

and
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left(bd-c^{2}\right)=\dot{g}\left(\lambda_{1}/\kappa_{1}\right)\dot{g}\left(\lambda_{2}/\kappa_{2}\right)>0
\]

\end_inset

regardless of the choice of 
\begin_inset Formula $\kappa_{1}$
\end_inset

 and 
\begin_inset Formula $\kappa_{2}$
\end_inset

.
 Finally, we chose 
\begin_inset Formula $\kappa_{1}=1\mbox{ and }\kappa_{2}=\mu$
\end_inset

 in order to include the case 
\begin_inset Formula $\mu=0$
\end_inset

.
\end_layout

\begin_layout Subsection*
Case 
\begin_inset Formula $\mathbf{z}_{T}=\mathbf{0}$
\end_inset


\end_layout

\begin_layout Standard
For 
\begin_inset Formula $\kappa_{1}=1\mbox{ and }\kappa_{2}=\mu$
\end_inset

 we have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
a=\frac{\mu g\left(\lambda_{2}/\mu\right)-\mu g\left(\lambda_{1}\right)}{\left\Vert \mathbf{z}_{T}\right\Vert },b=\frac{\mu^{2}\dot{g}\left(\lambda_{1}\right)+\dot{g}\left(\lambda_{2}/\mu\right)}{1+\mu^{2}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
c=\frac{\mu\left(\dot{g}\left(\lambda_{1}\right)-\dot{g}\left(\lambda_{2}/\mu\right)\right)}{1+\mu^{2}},d=\frac{\dot{g}\left(\lambda_{1}\right)+\mu^{2}\dot{g}\left(\lambda_{2}/\mu\right)}{1+\mu^{2}}\mbox{.}
\]

\end_inset

From (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:l12"

\end_inset

) we notice that 
\begin_inset Formula $\left\Vert \mathbf{z}_{T}\right\Vert =\lambda_{2}-\mu\lambda_{1}$
\end_inset

 and hence for 
\begin_inset Formula $\mathbf{z}_{T}\rightarrow\mathbf{0}$
\end_inset

 there holds 
\begin_inset Formula $\lambda_{2}\rightarrow\mu\lambda_{1}$
\end_inset

.
 By using the above formulas we can see
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\lim_{\mathbf{z}_{T}\rightarrow\mathbf{0}}a=\lim_{\lambda_{2}\rightarrow\mu\lambda_{1}}\frac{\mu g\left(\lambda_{2}/\mu\right)-\mu g\left(\lambda_{1}\right)}{\lambda_{2}-\mu\lambda_{1}}=\dot{g}\left(\lambda_{1}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\lim_{\mathbf{z}_{T}\rightarrow\mathbf{0}}b=\lim_{\lambda_{2}\rightarrow\mu\lambda_{1}}\frac{\mu^{2}\dot{g}\left(\lambda_{1}\right)+\dot{g}\left(\lambda_{2}/\mu\right)}{1+\mu^{2}}=\dot{g}\left(\lambda_{1}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\lim_{\mathbf{z}_{T}\rightarrow\mathbf{0}}c=\lim_{\lambda_{2}\rightarrow\mu\lambda_{1}}\frac{\mu\left(\dot{g}\left(\lambda_{1}\right)-\dot{g}\left(\lambda_{2}/\mu\right)\right)}{1+\mu^{2}}=0
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\lim_{\mathbf{z}_{T}\rightarrow\mathbf{0}}d=\lim_{\lambda_{2}\rightarrow\mu\lambda_{1}}\frac{\dot{g}\left(\lambda_{1}\right)+\mu^{2}\dot{g}\left(\lambda_{2}/\mu\right)}{1+\mu^{2}}=\dot{g}\left(\lambda_{1}\right)
\]

\end_inset

so that
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\lim_{\mathbf{z}_{T}\rightarrow\mathbf{0}}\nabla h\left(\mathbf{z}\right)=\dot{g}\left(\lambda_{1}\right)\mathbf{I}\mbox{.}\label{eq:dgI}
\end{equation}

\end_inset

It remains to linearize 
\begin_inset Formula $h\left(\mathbf{z}\right)$
\end_inset

 around 
\begin_inset Formula $\mathbf{z}_{T}=0$
\end_inset

 and show, that it results in the right hand side of (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:dgI"

\end_inset

).
 We have
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
h\left(\mathbf{z}+\triangle\mathbf{z}\right)=g\left(\lambda_{1}+\triangle\lambda_{1}\right)\mathbf{u}_{1}+\mu g\left(\left(\lambda_{2}+\triangle\lambda_{2}\right)/\mu\right)\mathbf{u}_{2},\,\,\,h\left(\mathbf{z}\right)=g\left(\lambda_{1}\right)\mathbf{u}_{1}+\mu g\left(\lambda_{2}/\mu\right)\mathbf{u}_{2}
\]

\end_inset

where
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\lambda_{1}=\frac{-z_{N}}{1+\mu^{2}},\,\,\,\lambda_{2}=\frac{-\mu z_{N}}{1+\mu^{2}},\triangle\lambda_{1}=\frac{-\triangle z_{N}-\mu\left\Vert \triangle\mathbf{z}_{T}\right\Vert }{1+\mu^{2}},\,\,\,\triangle\lambda_{2}=\frac{\left\Vert \triangle\mathbf{z}_{T}\right\Vert -\mu\triangle z_{N}}{1+\mu^{2}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mathbf{u}_{1}=\left\{ \begin{array}{ccc}
\left[\begin{array}{c}
-\mu\frac{\triangle\mathbf{z}_{T}}{\left\Vert \triangle\mathbf{z}_{T}\right\Vert }\\
-1
\end{array}\right] & \mbox{if} & \triangle\mathbf{z}_{T}\ne\mathbf{0}\\
\left[\begin{array}{c}
-\mu\mathbf{w}\\
-1
\end{array}\right] & \mbox{if} & \triangle\mathbf{z}_{T}=\mathbf{0}
\end{array}\right.,\,\,\,\mathbf{u}_{2}=\left\{ \begin{array}{ccc}
\left[\begin{array}{c}
\frac{\triangle\mathbf{z}_{T}}{\left\Vert \triangle\mathbf{z}_{T}\right\Vert }\\
-\mu
\end{array}\right] & \mbox{if} & \triangle\mathbf{z}_{T}\ne\mathbf{0}\\
\left[\begin{array}{c}
\mathbf{w}\\
-\mu
\end{array}\right] & \mbox{if} & \triangle\mathbf{z}_{T}=\mathbf{0}
\end{array}\right.
\]

\end_inset

and where 
\begin_inset Formula $\mathbf{w}\in R^{2}$
\end_inset

 and 
\begin_inset Formula $\left\Vert \mathbf{w}\right\Vert =1$
\end_inset

.
 There also holds
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
g\left(\lambda_{1}+\triangle\lambda_{1}\right)-g\left(\lambda_{1}\right)=\dot{g}\left(\lambda_{1}\right)\triangle\lambda_{1}+o\left(\triangle\lambda_{1}\right)=\dot{g}\left(\lambda_{1}\right)\triangle\lambda_{1}+o\left(\left\Vert \triangle\mathbf{z}\right\Vert \right)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\mu g\left(\left(\lambda_{2}+\triangle\lambda_{2}\right)/\mu\right)-\mu g\left(\lambda_{2}/\mu\right)=\dot{g}\left(\lambda_{2}/\mu\right)\triangle\lambda_{2}+o\left(\left\Vert \triangle\mathbf{z}\right\Vert \right)
\]

\end_inset

where 
\begin_inset Formula $\beta=o\left(\alpha\right)$
\end_inset

 if 
\begin_inset Formula $\beta/\alpha\rightarrow0$
\end_inset

 as 
\begin_inset Formula $\alpha\rightarrow0$
\end_inset

.
 Tentatively assuming that 
\begin_inset Formula $\triangle\mathbf{z}_{T}\ne\mathbf{0}$
\end_inset

 and keeping in mind that 
\begin_inset Formula $\left\Vert \triangle\mathbf{z}_{T}\right\Vert =\triangle\lambda_{2}-\mu\triangle\lambda_{1}$
\end_inset

, 
\begin_inset Formula $0=\lambda_{2}-\mu\lambda_{1}$
\end_inset

 and 
\begin_inset Formula $\triangle\lambda_{1}+\mu\triangle\lambda_{2}=-\triangle z_{N}$
\end_inset

, we can write
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{eqnarray*}
h\left(\mathbf{z}+\triangle\mathbf{z}\right)-h\left(\mathbf{z}\right) & = & \left(g\left(\lambda_{1}+\triangle\lambda_{1}\right)-g\left(\lambda_{1}\right)\right)\mathbf{u}_{1}+\mu\left(g\left(\left(\lambda_{2}+\triangle\lambda_{2}\right)/\mu\right)-g\left(\lambda_{2}/\mu\right)\right)\mathbf{u}_{2}\\
 & = & \dot{g}\left(\lambda_{1}\right)\triangle\lambda_{1}\mathbf{u}_{1}+\dot{g}\left(\lambda_{2}/\mu\right)\triangle\lambda_{2}\mathbf{u}_{2}+o\left(\left\Vert \triangle\mathbf{z}\right\Vert \right)\\
 & = & \dot{g}\left(\lambda_{1}\right)\left[\begin{array}{c}
\left(\triangle\lambda_{2}-\mu\triangle\lambda_{1}\right)\frac{\triangle\mathbf{z}_{T}}{\left\Vert \triangle\mathbf{z}_{T}\right\Vert }\\
-\triangle\lambda_{1}-\mu\triangle\lambda_{2}
\end{array}\right]+o\left(\left\Vert \triangle\mathbf{z}\right\Vert \right)\\
 & = & \dot{g}\left(\lambda_{1}\right)\triangle\mathbf{z}+o\left(\left\Vert \triangle\mathbf{z}\right\Vert \right)\mbox{.}
\end{eqnarray*}

\end_inset

Hence, as required
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\nabla h\left(\mathbf{z}\right)=\dot{g}\left(\lambda_{1}\right)\mathbf{I}\mbox{.}
\]

\end_inset


\end_layout

\begin_layout Section
Appendix - Links
\begin_inset CommandInset label
LatexCommand label
name "sec:Links"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO: add links
\end_layout

\end_inset


\end_layout

\begin_layout Section*
Acknowledgements
\end_layout

\begin_layout Standard
The support from EDF Energy is gratefully acknowledged.
\end_layout

\begin_layout Section*
Revision notes
\end_layout

\begin_layout Description
Rev.
\begin_inset space ~
\end_inset

1 Initial revision;
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "/Users/tomek/Dropbox/tkwork/bibs/my,/Users/tomek/Dropbox/tkwork/bibs/contact-related,/Users/tomek/Dropbox/tkwork/bibs/mathematics,/Users/tomek/Dropbox/tkwork/bibs/time-stepping,/Users/tomek/Dropbox/tkwork/bibs/books,/Users/tomek/Dropbox/tkwork/bibs/flexible-bodies"
options "unsrt"

\end_inset


\end_layout

\end_body
\end_document
